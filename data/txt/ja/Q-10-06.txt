日本の刑事事件を対象とした法律相談システム  中下咲帆1 菊池英明1 藤倉将平2 則竹理宇2  1早稲田大学人間科学研究科 2LawFlow 株式会社 nakashitas@gmail.com  kikuchi@waseda.jp fujikura@lawflow.jp  noritakebengo@keiji-bengosi.com   概要 本研究は、⽇本の刑法を対象とした法律相談システムの構築を⽬指して「罪名」「量刑」「量刑根拠」 の 3 つの予測に取り組んだ。
弁護⼠へのヒアリングを基に構築した罪名データベースを参照するように設計した罪名予測モジュールは、正解割合の平均が70%となり⽬標の 80%には達しなかった。
弁護⼠へのヒアリングを基に構築した量刑根拠データベースを参照するように設計した量刑根拠予測モジュールは、正解割合の平均が 89%となり、⽬標の 80%に達した。
過去の量刑事例集を参照させるように設計した量刑予測モジュールは、正解割合の平均が 43%となり、⽬標の 80%を⼤きく下回った. 1 はじめに 1. 1 背景 2022 年以降、ChatGPT[1]をはじめとする大規模言語モデル（LLM）の進展により、法律分野での LLM活用が期待されている。
中国では幅広い法律相談に自動で回答するために、弁護士が行っている思考プロセスを反映させた LLM の開発研究[2]が行われている。
日本でも民間企業においてそのような取り組みが行われている事例[3][4]はあるが、学術研究として公開されている取り組み事例は少ない。
また，JURISIN[5]や COLIEE[6]などの法的タスクを目的としたワークショップでは、司法試験や民事判決に関するデータを扱うタスク[7][8]は存在するが、刑事事件に関するタスクはない。
 


1. 2 目的 

本研究の⽬的は、⽇本の刑法を対象とした再現性のある法律相談システムの構築を通じて、刑事事件に関連する法的⽀援を提供することである。
法的なトラブルは⼤きく⺠事と刑事に分かれるが、本研究では類似の先⾏研究が少ない刑事事件に注⽬する。
さらに複数のカテゴリが存在する刑事事件の中で件数が多く法的⽀援の需要が⾼い「交通」に関する罪に焦点を当てる。  具体的には，「罪名」「量刑」「量刑根拠」の 3つの予測を⾏うことを⽬的とする。
現状の LLMは類似する罪名の区別や妥当な量刑相場の予測において誤りを犯すことが多いため、本研究ではまずこの問題を解決し、より的確な応答が可能な法律相談システムの構築を⽬指す。
本研究で⽬的とする対話例を図1 に⽰す。   
図 1. 目的とする対話例 2 提案手法 2. 1 システム概要 本システムは、前述の⽬的にて⽰した各タスクに対応するために「罪名予測モジュール」「量刑根拠予測モジュール」「量刑予測モジュール」の3 つの予測モジュールで構成されている。
 
図 2 は提案システムにおける⼊出⼒の流れである。
はじめにユーザからの法的な相談内容が罪名予測モジュールに⼊⼒され、罪名が出⼒される。
続いて、相談内容と予測された罪名が量刑根拠予測モジュールに⼊⼒され，量刑根拠が出⼒される。
最後に、相談内容と予測された罪名及び量刑根拠が量刑予測モジュールに⼊⼒され、量刑が出⼒される。
これら 3 つのモジュール

で
予測された罪名、量刑根拠、量刑の情報がまとめてユーザに返される。
  
図 2. 提案システムの流れ 2. 2 罪名予測モジュール 罪名予測モジュールは、ユーザの事件内容を入力とし、それに対して最も可能性の高い罪名を 3 つ出力する。
予測時のプロンプトでは、弁護⼠へのヒアリングを基に構築した罪名データベースを参照する形式になっている。
 
2. 2. 1 罪名の大分類 罪名は予測対象のカテゴリが多いため、⼤分類と詳細分類の 2 段階に分かれている。
罪名データベースも各段階で分かれている。
指⽰⽂は「ユーザが⼊⼒する法的案件と次の罪名データベースを照らし合わせて、確率の⾼い罪を JSON 形式で出⼒してください」とし、⼤まかな罪名カテゴリを特定するための罪名データベースを参照させる。
 
⼤分類のための罪名データベースには 13 カテゴリが含まれている。
出⼒は、罪名データベースの中から選ばれた可能性の⾼い罪名カテゴリ（「交通に対する罪」など）となっている。
複数のカテゴリが該当する場合には複数のカテゴリを出⼒する。
2. 2. 2 罪名の詳細分類 続いて、2 段階⽬の詳細分類に進む。
指⽰⽂は「ユーザが⼊⼒する法的案件と次の罪名データベースを照らし合わせて、確率の⾼い罪を JSON 形式で確率の⾼い順に 3 つ出⼒してください」とし、詳細な罪名を特定するための罪名データベースを参照させる。
 
詳細分類のための罪名データベースは⼤分類のカテゴリ毎に 12 種類が存在する。
出⼒は、罪名データベースに記載された詳細な罪名の中から、可能性の⾼い 3 つの罪が選ばれる形になっている。
 
2. 2. 3 最新罪名への対応 法改正によって改名された罪名が、罪名予測時に旧罪名のままで出⼒されてしまう課題があった。
これに対応するために、新罪名を検索する過程を追加した。
検索には Google 検索 API を使⽤し，「〇〇罪の最新罪名を検索してください」というクエリを指定した。
抽出対象は、記事のタイトル、URL，スニペットの 3 つである。
スニペットとは、Web ページの要約⽂や説明⽂を指す。
出⼒される記事の上限は 10 件である。
続いてこの検索結果を元に、最新罪名の予測を gpt-4o で⾏う。
検索結果を参照情報として、対象罪名の最新罪名を予測させる。
プロンプトは「〇〇罪の最新罪名のみを予測してください」とした。
これらの過程を踏まえて、最新罪名の確認を⾏い、それを罪名予測の最終的な出⼒とする。
 
2. 3 量刑根拠予測モジュール 量刑根拠予測モジュールは、ユーザの事件内容と罪名予測の結果を⼊⼒とし、量刑の根拠に影響する項⽬を出⼒する。
指⽰⽂は「ユーザが⼊⼒する法的案件と次の量刑根拠データベースを照らし合わせて、量刑の判断根拠を出⼒してください」というような形で、弁護⼠へのヒアリングを基に構築した量刑根拠データベースを参照させる。
量刑根拠データベースのカテゴリは「交通に関する罪」とし、このカテゴリに含まれる要素数は 24 となっている。
 
2. 4 量刑予測モジュール 量刑予測モジュールは、ユーザの事件内容と罪名予測及び量刑根拠予測の結果を⼊⼒とし、確率の⾼い量刑を 2 つ出⼒する。
予測時の指⽰⽂は「ユーザが⼊⼒する量刑の相場表を参照して、根拠を⽰しながら具体的な量刑を予測してください」とし、過去の量刑事例集[9][10][11]を参照させる。
「交通に関する罪」の事例数は 1003 件である。
量刑事例集はカテゴリ毎にテーブルが分かれているため、罪名予測の結果を元に該当カテゴリのテーブルだけを参照させる。
出⼒は、量刑事例集を参照した上での相場感と、それを踏まえた量刑予測結果で構成されている。
   

3 評価 評価は「交通に関する罪」を対象とする。
 
3. 1 

本文テストデータの作成

 テストデータには過去の裁判例を使⽤する。
テストデータは、罪名データベースの「 交通に関する罪」に含まれる全罪名の中から、裁判例が⼊⼿できた 16罪名分のデータ 16 件である。
第⼆審以降の判例は情報が省略されているケースが⾒られたため、情報が構造的かつ網羅的に記載されている第⼀審の判例のみを集めた。  
続いて、収集した過去の裁判例から、テストデータとなる「事件内容」「罪名」「量刑」「量刑根拠」の 4 項⽬にあたる情報を Claude-3. 5-Sonnet で抽出する。
判例の中で、これらの 4 項⽬に対応する情報を表 1 に⽰す。
判例には書誌情報と全⽂が存在するため、それぞれから抽出できる情報を分けて⽰す。  
表 1. 裁判例からのテストデータ抽出 テストデータの構成要素 書誌から 抽出する情報 全⽂から 抽出する情報 事件内容 要旨 罪となるべき事実 罪名 事件名/ 参照法令 法令の適⽤ 量刑 裁判結果 主⽂ 量刑根拠 要旨 量刑の理由  3. 2

罪名予測の評価

 罪名予測の評価は、罪名予測モジュールで最終的に予測された詳細な罪名に対して⾏う。
予測された罪名の中に、正解の罪名が含まれている割合を評価する。
この割合がテストデータの平均において 80%を超えることを⽬標とする。  
罪名予測の正解割合の平均は 70%となり、⽬標の80%には達しなかった。  
３つのモジュールそれぞれについて、予測のミスケースをみていく。
 
まず、罪名の⼤分類については、不特定多数への被害があるケースに適⽤される「公共の安全に対する罪」の出⼒がミスケースとして⽬⽴った。
このように間違って出⼒されることの多い罪名カテゴリについては、該当カテゴリの具体的な構成要件を追加することで判別の精度が向上するのではないかと考える。  
続いて、罪名の詳細分類のミスケースを以下に整理する。  
1. 過失運転致死傷と危険運転致死傷の判別ミス 2. 罪名データベースに含まれる罪名が正式な罪名ではなく通称や総称の罪名になってしまっていたケース 3. 罪名データベースに記載されていなかったマイナーな罪名の予測ができていなかったケース 4. 最新罪名の検索で「 検索できません」という出⼒になってしまったケース 5. 最新罪名の検索で旧罪名に対応しない全く別の罪名に変換してしまったミス 6. 最新罪名の検索で旧罪名を旧罪名のまま出⼒してしまったミス 1 について、正確な判別は弁護⼠でも意⾒が分かれるほど難しいタスクであるため、初歩的な対応策として、それぞれの罪名の法条をプロンプトに記載し、ルールベースで参照させることが考えられる。  
2・3 への対応については、罪名データベースの構築基準を修正する必要がある。
罪名は通称ではなく正式名称で記載することや、記載する罪名の粒度の調整が挙げられる。
 
4・5・6 については、最新罪名の検索モジュールが期待通りに機能していない結果を⽰してしまっているため、最新罪名への対応⽅針を Google 検索から辞書検索に切り替えるべきだと考える。
旧罪名と最新罪名のペアデータを含むような辞書を作成し、そちらを検索することで今よりも適切な変換が可能になるだろう。
 
3. 3

量刑根拠予測の評価

 量刑根拠予測では、テストデータの事件内容と前段で予測された罪名を⼊⼒とし、予測された量刑根拠と正解の量刑根拠を著者が⽐較評価する。
予測された量刑根拠の各項⽬に、正解の項⽬が含まれている割合を評価する。
この割合がテストデータの平均において 80%を超えることを⽬標とする。  
量刑根拠予測の正解割合の平均は 89%となり、⽬標の 80%に達した。
評価値が⽬標を超えることができたのは、予測時に参照した量刑根拠データベースが網羅的に構築できていたからだと考える。
弁護⼠

から
の
確認をもらいながら、複数回のテストを繰り返し最適なデータベースの作成を⾏なった。
 
3. 4

量刑予測の評価

 量刑予測では、テストデータの事件内容と前段で予測された罪名及び量刑根拠を⼊⼒し、予測された量刑が弁護⼠の判断する量刑の範囲内に含まれる割合を評価する。
前述した割合がテストデータの平均として 80%を超えることを⽬標とする。  
量刑予測の正解割合の平均は 43%となり、⽬標の80%を⼤きく下回った。
 
ミスケースは 16 件中 9 件となった。
ミスケース 9件のうち、予測された量刑が正解よりも重くなったケースが 5 件、逆に正解よりも軽くなったケースが4 件である。
 
正解と⼤きなズレのあるミスはいずれもシステムとして致命的であるが、実応⽤場⾯では正解よりも軽い量刑を予測してしまうケースの⽅が、ユーザにとっては問題であると考える。
量刑予測におけるミスケースの原因は以下のパターンになっていた。
 
1. 罪名予測のミスが量刑予測のミスに繋がっているケース 2. 複数の罪名が正解となる場合に⼀部の罪名を正しく予測できないケース 3. 参照する過去の量刑事例集の情報量が少ないケース 1 については、罪名予測で間違って予測された罪名がそのまま量刑予測の⼊⼒として扱われているケースである。
このケースへの対応は前述した罪名予測の改善になる。
 
2 については、複数の罪が絡む併合罪のケースであるが、罪名予測の時点で、適⽤される罪が網羅的に予測できていないことで量刑を正しく加重できていない可能性がある。
このケースへの対応としては、罪名予測の考察に記載した内容に重なるが、罪名データベースに記載する罪名を網羅的に拡充することが必要になる。
 
3 については、今回プロンプトで参照している過去の量刑事例集において、該当罪名の事例がほとんどないケース（救護義務違反や酒酔い運転幇助など）や、該当罪名の事例はあるが事件内容が簡略化されており、個別事例としての具体的な情報がほとんどないケースがあった。
これらは参照情報がないという状態に等しいため、事例集の拡充が対応策となる。
 
4 おわりに  本研究では「罪名」「量刑」「量刑根拠」の 3 つの予測モジュールの構築に取り組んだ。
各モジュールの正解割合を表 2 に⽰す。  
表 2. 各モジュールの正解割合 モジュール名 正解割合 ⽬標割合 罪名予測 モジュール 70% 80% 量刑根拠 モジュール 89% 80% 量刑 モジュール 43% 80%  罪名予測モジュール 罪名の⼤分類においては、主要なカテゴリである交通及び⾝体カテゴリの予測ができていた⼀⽅で、関係のないカテゴリの出⼒もあった。
罪名の詳細分類においては、弁護⼠でも判断の難しい罪名の予測ミスや罪名データベースに記載のない罪名の予測ミスが⽬⽴った。
また、最新罪名の検索モジュールが期待通りに機能しなかった。
今後は、罪名データベースの修正、複雑な罪名に対するルールベースの規定、最新罪名の取得に向けた辞書の作成に取り組む。  
量刑根拠予測モジュール 量刑根拠データベースが上⼿く機能している結果ではあったが、考察に記述した量刑根拠データベースの改善点を反映させることでさらに⾼精度な量刑根拠予測が可能になるだろう。  
量刑予測モジュール 実際の量刑よりも軽い量刑を予測してしまうという致命的なミスがみられたため、罪名予測の改善に加え、参照する量刑事例集の拡充に取り組む必要がある。
 



参考文献 


[1] OpenAI. ChatGPT. (引⽤⽇:2025/01/09.). https://openai.com/blog/chatgpt. 
[2] Jiaxi Cui, et al. Chatlaw: A Multi-Agent Collaborative Legal Assistant with Knowledge Graph. Enhanced Mixture-of-Experts Large Language Model. arXiv:2306.16092v2 (引⽤⽇: 2025/01/09.) 
[3]  弁護⼠ドットコム.  チャット法律相談(α). (引⽤⽇: 2025/01/09.) https://chat.bengo4.com/. 
[4] Legal AI. AI  弁護⼠法律相談ツール. (引⽤⽇: 2025/01/09.) https://legalai.co.jp/#/. 
[5] JURISIN2024. (引⽤⽇: 2025/01/09.). https://jurisinformaticscenter.github.io/jurisin2024/. 
[6] COLIEE-2024 CALL FOR TASK PARTICIPATION. (引⽤⽇: 2025/01/09.). https://sites.ualberta.ca/~rabelo/COLIEE2024/. 
[7] Hai-Long Nguyen, et al. Enhancing Legal Document Retrieval: A Multi-Phase Approach with. Large Language Models. Proceedings of the 18th International Workshop on Juris-Informatics, pp.86-pp.100, 2024. (引⽤⽇: 2025/01/09.) https://jurisinformaticscenter.github.io/jurisin2024/jurisin2024local_proceedings.pdf 
[8] Housam Khalifa Bashier Babiker, et al. Legal Yes/No Question Answering Through Text. Embedding, Fine-Tuning, and Prompt Engineering. Proceedings of the 18th International Workshop on Juris-Informatics, pp.170-pp.180, 2024. (引⽤⽇: 2025/01/09.) https://jurisinformaticscenter.github.io/jurisin2024/jurisin2024local_proceedings.pdf 
[9]  第⼀東京弁護⼠会,  刑事弁護委員会.  量刑調査報告集Ⅲ, pp.12-pp.22, 2010. 
[10]  第⼀東京弁護⼠会,  刑事弁護委員会.  量刑調査報告集Ⅳ, pp.13-pp.19, 2015. 
[11]  第⼀東京弁護⼠会,  刑事弁護委員会.  量刑調査報告集Ⅴ, pp.12-pp.16, 2018.  