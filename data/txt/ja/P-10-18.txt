é©å¿œçš„å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ã®ãŸã‚ã®çµ‚ç›¤ã®ä¼šè©±ã‚’äºˆæ¸¬ã™ã‚‹åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰

é£¯å¡šæ…ä¹Ÿ æ±ä¸­ç«œä¸€éƒ



åå¤å±‹å¤§å­¦å¤§å­¦é™¢æƒ…å ±å­¦ç ”ç©¶ç§‘



iizuka.shinya.a8@s.mail.nagoya-u.ac.jp



higashinaka@i.nagoya-u.ac.jp



æ¦‚è¦

æœ¬ç ”ç©¶ã§ã¯ã€å¯¾è©±ç›¸æ‰‹ã«é©å¿œã—ãŸå¿œç­”ç”Ÿæˆã‚’ç›®æŒ‡ã—ã€åºç›¤ã®å¯¾è©±ã‹ã‚‰ã€ãã®è©±è€…ã¨ã®çµ‚ç›¤ã®å¯¾è©±ã‚’äºˆæ¸¬ã™ã‚‹ãŸã‚ã®åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€å¯¾ç…§å­¦ç¿’ã‚’åˆ©ç”¨ã—ã€è©±ã—æ–¹ã«åŸºã¥ã„ã¦åºç›¤ã¨çµ‚ç›¤ã¨ã‚’ç´ã¥ã‘ã‚‹åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹ã€‚
ã•ã‚‰ã«ã€æœ€è¿‘å‚æ¢ç´¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹ Faiss ã‚’ç”¨ã„ã¦åºç›¤ã®å¯¾è©±ã‹ã‚‰ã€é¡ä¼¼ã—ãŸè©±ã—æ–¹ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ã®çµ‚ç›¤ã®å¯¾è©±ã‚’ç²å¾—ã™ã‚‹ä»•çµ„ã¿ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚
æœ¬æ‰‹æ³•ã®è©•ä¾¡ã§ã¯ã€æ—…è¡Œä»£ç†åº—ã‚¿ã‚¹ã‚¯å¯¾è©±ã‚³ãƒ¼ãƒ‘ã‚¹ï¼ˆTabidachiï¼‰ãŠã‚ˆã³ RealPersonaChatï¼ˆRPCï¼‰ã‚³ãƒ¼ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã€ææ¡ˆãƒ¢ãƒ‡ãƒ«ãŒåºç›¤ã®å¯¾è©±ã‹ã‚‰çµ‚ç›¤ã®å¯¾è©±ã‚’äºˆæ¸¬ã™ã‚‹ãŸã‚ã®åŸ‹ã‚è¾¼ã¿è¡¨ç¾ã®ç²å¾—ã«æœ‰åŠ¹ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸã€‚


1 ã¯ã˜ã‚ã«

å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ï¼ˆLarge Language Model; LLMï¼‰ã®ç™»å ´ã«ã‚ˆã‚Šã€å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ã®æ€§èƒ½ã¯é£›èºçš„ã«å‘ä¸Šã—ã¦ã„ã‚‹[1, 2, 3, 4]ã€‚
ãã®ã‚ˆã†ãªå¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ãŒæ™®åŠã—ã¦ã„ãä¸­ã§ã€äººé–“ãŒå¯¾è©±ã«ãŠã„ã¦è¡Œã†ã€ç›¸æ‰‹ã®æ€§åˆ¥ã‚„å¹´ä»£ã€æ€§æ ¼ã«åˆã‚ã›ãŸè©±ã—æ–¹ã®èª¿æ•´ã¯ã€ã‚¿ã‚¹ã‚¯ã®é”æˆã‚„æº€è¶³åº¦å‘ä¸Šã«ãŠã„ã¦ã€ã‚ˆã‚Šé‡è¦ã¨ãªã£ã¦ã„ã‚‹ã€‚
ã“ã‚Œã¾ã§ã«ã€ç›¸æ‰‹ã«é©å¿œã™ã‚‹å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹å–ã‚Šçµ„ã¿ã¯ã„ãã¤ã‹ææ¡ˆã•ã‚Œã¦ã„ã‚‹[5, 6, 7]ã€‚
ã—ã‹ã—ã€å¾“æ¥ã®å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€é©å¿œã®ãƒ«ãƒ¼ãƒ«ã‚„è©±ã—æ–¹ã®èª¿æ•´æ–¹æ³•ã‚’äº‹å‰ã«è¨­è¨ˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€æœªçŸ¥ã®ãƒ¦ãƒ¼ã‚¶ã«æŸ”è»Ÿã«é©å¿œã™ã‚‹ã“ã¨ãŒé›£ã—ã„ã€‚
æˆ‘ã€…ã¯ã€å¯¾è©±ç›¸æ‰‹ã®è©±ã—æ–¹ã«ç€ç›®ã—ã€åºç›¤ã®å¯¾è©±ã‹ã‚‰å¯¾è©±ç›¸æ‰‹ã¨ã®çµ‚ç›¤ã®å¯¾è©±ã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ã§ã€å¯¾è©±ç›¸æ‰‹ã«é©å¿œã—ãŸå¿œç­”ç”Ÿæˆã‚’å®Ÿç¾ã™ã‚‹æ‰‹æ³•ã‚’ææ¡ˆã™ã‚‹ã€‚
äººé–“ã®å¯¾è©±ã§ã¯ã€é€²è¡Œã«ä¼´ã„äº’ã„ã®è©±ã—æ–¹ãŒèª¿æ•´ã•ã‚Œã€è¦ªå¯†ã•ã‚„ä¿¡é ¼æ„ŸãŒç¯‰ã‹ã‚Œã‚‹[8]ã€‚
ã¾ãŸã€ä¼šè©±å›³ 1 å¯¾è©±ç›¸æ‰‹ã«é©å¿œã—ãŸå¿œç­”ç”Ÿæˆã‚’è¡Œã†æ‰‹æ³•ã®æ¦‚è¦ã€‚
ã«ãŠã‘ã‚‹è¨€èªã‚¹ã‚¿ã‚¤ãƒ«ã®é©å¿œãŒã€ç›¸æ‰‹ã¸ã®é–¢ä¸ã‚„ç›¸äº’ç†è§£ã‚’é«˜ã‚ã‚‹ã†ãˆã§é‡è¦ãªå½¹å‰²ã‚’æœãŸã™ã“ã¨ã‚‚ç¤ºå”†ã•ã‚Œã¦ã„ã‚‹[9]ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€åºç›¤ã®å¯¾è©±ã‹ã‚‰çµ‚ç›¤ã®è©±ã—æ–¹ã‚’äºˆæ¸¬ã—ã€ãã®çµæœã‚’å¿œç­”ç”Ÿæˆã«æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€é€šå¸¸å¯¾è©±ã‚’é‡ã­ã‚‹ä¸­ã§å¾—ã‚‰ã‚Œã‚‹é©å¿œã‚’çŸ­æ™‚é–“ã§å®Ÿç¾ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã™ã€‚
å›³ 1 ã«æ‰‹æ³•ã®æ¦‚è¦ã‚’ç¤ºã™ã€‚
æœ¬æ‰‹æ³•ã§ã¯ã€å¯¾ç…§å­¦ç¿’[10]ã‚’åˆ©ç”¨ã—ã€è©±ã—æ–¹ã«åŸºã¥ã„ã¦åºç›¤ã¨çµ‚ç›¤ã¨ã‚’ç´ã¥ã‘ã‚‹åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹ã€‚
ã•ã‚‰ã«ã€æœ€è¿‘å‚æ¢ç´¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹ Faiss1ï¼‰[11]ã‚’ç”¨ã„ã¦åºç›¤ã®å¯¾è©±ã‹ã‚‰é¡ä¼¼ã—ãŸè©±ã—æ–¹ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ã®çµ‚ç›¤ã®å¯¾è©±ã‚’ç²å¾—ã™ã‚‹ä»•çµ„ã¿ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚
å®Ÿéš›ã®å¯¾è©±æ™‚ã«ã¯ã€è“„ç©ã•ã‚ŒãŸå¯¾è©±å±¥æ­´ã‹ã‚‰ã€å¯¾è©±ç›¸æ‰‹ã¨ã®çµ‚ç›¤ã®å¯¾è©±ã¨ãªã‚‹ã‚‚ã®ã‚’æ¤œç´¢ã—ã€ãã‚Œã‚’åˆ©ç”¨ã—ã¦å¯¾è©±ç›¸æ‰‹ã«é©å¿œã—ãŸç™ºè©±ã‚’å®Ÿç¾ã™ã‚‹ã€‚
ä¾‹ãˆã°ã€å¾—ã‚‰ã‚ŒãŸå¯¾è©±ã‚’ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ã‚·ãƒ§ãƒƒãƒˆã¨ã—ã¦å«ã‚ã‚‹ãªã©ãŒæƒ³å®šã•ã‚Œã‚‹ã€‚
æœ¬ç¨¿ã§ã¯ã€åºç›¤ã®å¯¾è©±ã‹ã‚‰ã€ãã®è©±è€…ã¨ã®çµ‚ç›¤ã®å¯¾è©±ã‚’äºˆæ¸¬ã™ã‚‹ãŸã‚ã®åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ã¨è©•ä¾¡ã‚’è¡Œã£ãŸã€‚
è©•ä¾¡ã®çµæœã€å¯¾ç…§å­¦ç¿’ã‚’å°å…¥ã™ã‚‹ã“ã¨ã§ã€çµ‚ç›¤ã®å¯¾è©±ã«å¯¾ã™ã‚‹æ¤œç´¢ã®ç²¾åº¦ãŒå‘ä¸Šã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸã€‚
ç‰¹ã«ã€ä¸€ã¤ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã«å«ã‚ã‚‹ç™ºè©±æ•°ã‚’å¢—ã‚„ã—ãŸå ´åˆã«å¤§å¹…ãªç²¾åº¦å‘ä¸ŠãŒè¦‹ã‚‰ã‚Œã€é•·ã„æ–‡è„ˆæƒ…å ±ãŒè©±ã—æ–¹ã®ç‰¹å¾´ã‚’æ‰ãˆã‚‹ä¸Šã§æœ‰åŠ¹ã§ã‚ã‚‹ã“ã¨ãŒç¤ºã•ã‚ŒãŸã€‚
1ï¼‰ https://github.com/facebookresearch/faiss




2 é–¢é€£ç ”ç©¶



2.1 ãƒ¦ãƒ¼ã‚¶ã«é©å¿œã™ã‚‹å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ 

Komatani ã‚‰ã¯ã€ãƒ¦ãƒ¼ã‚¶ã®ã€Œã‚·ã‚¹ãƒ†ãƒ ã«å¯¾ã™ã‚‹ç¿’ç†Ÿåº¦ã€ï¼Œã€Œãƒ‰ãƒ¡ã‚¤ãƒ³ã«é–¢ã™ã‚‹çŸ¥è­˜ãƒ¬ãƒ™ãƒ«ã€ï¼Œã€Œæ€§æ€¥åº¦ã€ã‚’æ¨å®šã—ã¦ãƒ¦ãƒ¼ã‚¶ã«å¿œã˜ã¦ã‚·ã‚¹ãƒ†ãƒ ã®æŒ¯ã‚‹èˆã„ã‚’å¤‰åŒ–ã•ã›ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ãŸ[5]ã€‚
ã¾ãŸã€Ohashi ã‚‰ã¯ã€å¼·åŒ–å­¦ç¿’ã‚’æ´»ç”¨ã—ã¦ç’°å¢ƒãƒã‚¤ã‚ºã‚„ãƒ¦ãƒ¼ã‚¶ã®èªå½™ãƒ¬ãƒ™ãƒ«ã«é©å¿œã™ã‚‹ç™ºè©±ç”Ÿæˆã‚’ææ¡ˆã—ãŸ[6]ã€‚
ã•ã‚‰ã«ã€Yamamoto ã‚‰ã¯ã€ãƒ¦ãƒ¼ã‚¶ã®æ€§æ ¼ã«å¿œã˜ãŸã‚·ã‚¹ãƒ†ãƒ ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿è¡¨ç¾ã‚’è¨­è¨ˆã—ã€å¯¾è©±ã®å°è±¡å‘ä¸Šã‚’ç›®æŒ‡ã—ãŸ[7]ã€‚
ã—ã‹ã—ã€å¾“æ¥ã®å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€é©å¿œã®ãƒ«ãƒ¼ãƒ«ã‚„è©±ã—æ–¹ã®èª¿æ•´æ–¹æ³•ã‚’ã‚ã‚‰ã‹ã˜ã‚è¨­è¨ˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€æœªçŸ¥ã®ãƒ¦ãƒ¼ã‚¶ã«å¯¾ã—ã¦æŸ”è»Ÿã«é©å¿œã™ã‚‹ã“ã¨ãŒé›£ã—ã„ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€åºç›¤ã®å¯¾è©±ã‹ã‚‰ã€ãã®è©±è€…ã¨ã®çµ‚ç›¤ã®å¯¾è©±ã‚’äºˆæ¸¬ã™ã‚‹ãŸã‚ã®åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€æœªçŸ¥ã®ãƒ¦ãƒ¼ã‚¶ã«ã‚‚é©å¿œå¯èƒ½ãªå¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿç¾ã‚’ç›®æŒ‡ã™ã€‚

2.2 è©±ã—æ–¹ã«ç€ç›®ã—ãŸåŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«

Akama ã‚‰ã¯ã€ã€ŒåŒä¸€ç™ºè©±å†…ã«å«ã¾ã‚Œã‚‹å˜èªã¯åŒä¸€ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’æŒã¤ã€ã¨ã„ã†ä»®å®šã®ã‚‚ã¨ã€ã‚¹ã‚¿ã‚¤ãƒ«ã«æ•æ„Ÿãªå˜èªåŸ‹ã‚è¾¼ã¿ã‚’å­¦ç¿’ã™ã‚‹ã“ã¨ã§ã€ç™ºè©±å…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’åæ˜ ã—ãŸåŸ‹ã‚è¾¼ã¿è¡¨ç¾ã‚’ç”Ÿæˆã™ã‚‹æ‰‹æ³•ã‚’ææ¡ˆã—ãŸ[12]ã€‚
Zenimoto ã‚‰ã¯ã€å¯¾ç…§å­¦ç¿’ã‚’ç”¨ã„ã¦æ—¥æœ¬èªã®å¤šæ§˜ãªè©±ã—æ–¹ã‚’è¡¨ç¾ã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ãŸ[13]ã€‚
ã“ã‚Œã‚‰ã®ç ”ç©¶ã¯ã€ãƒ¦ãƒ¼ã‚¶ã®è©±ã—æ–¹ã«ç„¦ç‚¹ã‚’å½“ã¦ã‚‹ã“ã¨ã§ã€å¾“æ¥ã‚ˆã‚Šã‚‚é©å¿œæ€§ã®é«˜ã„å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ã«è²¢çŒ®ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€ã“ã‚Œã‚‰ã®ç ”ç©¶ã¨åŒæ§˜ã«ãƒ¦ãƒ¼ã‚¶ã®è©±ã—æ–¹ã«ç€ç›®ã—ã€åºç›¤ã®å¯¾è©±ã¨çµ‚ç›¤ã®å¯¾è©±ã‚’ç´ã¥ã‘ã‚‹ã‚ˆã†ãªåŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚

3 ãƒ¦ãƒ¼ã‚¶ã®è©±ã—æ–¹ã«åŸºã¥ãå¯¾ç…§å­¦ç¿’

æœ¬ç ”ç©¶ã§ã¯ã€å¯¾ç…§å­¦ç¿’ã‚’ç”¨ã„ã¦ã€åºç›¤ã®å¯¾è©±ã‹ã‚‰ã€ãã®è©±è€…ã¨ã®çµ‚ç›¤ã®å¯¾è©±ã‚’äºˆæ¸¬ã™ã‚‹ãŸã‚ã®åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ã‚’ç›®æŒ‡ã™ã€‚
æœ¬ç ”ç©¶ã«ãŠã‘ã‚‹å¯¾ç…§å­¦ç¿’ã®æ¦‚è¦ã‚’å›³ 2 ã«ç¤ºã™ã€‚
ã‚ã‚‹ãƒ¦ãƒ¼ã‚¶ã®å¯¾è©±ãƒ‡ãƒ¼ã‚¿ã‚’ 1/3ãšã¤åˆ†å‰²ã—ã€ãã‚Œãã‚Œã‚’åºç›¤å¯¾è©±ï¼ˆğ·ğ‘ ğ‘¡ ğ‘ğ‘Ÿğ‘¡ï¼‰ã€ä¸­ç›¤å¯¾è©±ï¼ˆğ·ğ‘šğ‘–ğ‘‘ğ‘‘ğ‘™ğ‘’ï¼‰ã€çµ‚ç›¤å¯¾è©±ï¼ˆğ·ğ‘’ğ‘›ğ‘‘ï¼‰ã¨ã™ã‚‹ã€‚
åŒã˜è©±è€…ã®ã¿ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€è©±ã—æ–¹ã ã‘ã«ç€ç›®ã—ã€å†…å®¹ã«ä¾å­˜ã—ãªã„è©±ã—æ–¹ã®å¤‰åŒ–ã®ç‰¹å¾´ã‚’æ‰ãˆã‚‹ã€‚
ã‚¢ãƒ³ã‚«ãƒ¼ã¨ãªã‚‹ç™ºè©±é›†åˆã‚’ ğ·ğ‘ ğ‘¡ ğ‘ğ‘Ÿğ‘¡ã‹ã‚‰çª“å¹… ğ‘› ã§å–ã‚Šå‡ºã—ã€ãã‚Œã‚‰ã®ç™ºè©±ã‚’ç‰¹æ®Šãƒˆãƒ¼ã‚¯ãƒ³[ğ‘†ğ¸ ğ‘ƒ]ã§å›³ 2 ãƒ¦ãƒ¼ã‚¶ã®è©±ã—æ–¹ã«åŸºã¥ãå¯¾ç…§å­¦ç¿’ã®æ¦‚è¦ã€‚
åºç›¤ã®å¯¾è©±ï¼ˆã‚¢ãƒ³ã‚«ãƒ¼ï¼‰ã‚’åŸºã«ã€çµ‚ç›¤ï¼ˆæ­£ä¾‹ï¼‰ã¨ã®é¡ä¼¼æ€§ã‚’é«˜ã‚ã€ä¸­ç›¤ï¼ˆè² ä¾‹ï¼‰ã¨ã®é¡ä¼¼æ€§ã‚’ä¸‹ã’ã‚‹ã‚ˆã†ã«å­¦ç¿’ã‚’è¡Œã†ã€‚
é€£çµã™ã‚‹ã“ã¨ã§ä½œæˆã™ã‚‹ã€‚
åŒæ§˜ã«æ­£ä¾‹ã¨ãªã‚‹ç™ºè©±é›†åˆã€è² ä¾‹ã¨ãªã‚‹ç™ºè©±é›†åˆã‚’ãã‚Œãã‚Œ ğ·ğ‘’ğ‘›ğ‘‘ï¼Œğ·ğ‘šğ‘–ğ‘‘ğ‘‘ğ‘™ğ‘’ã‹ã‚‰ä½œæˆã™ã‚‹ã€‚
ã“ã‚Œã‚‰ã®æ–‡ã‚’ Encoder ã«å…¥åŠ›ã—ã€ãã‚Œãã‚ŒåŸ‹ã‚è¾¼ã¿ãƒ™ã‚¯ãƒˆãƒ«(ğ¸ğ‘, ğ¸ğ‘, ğ¸ğ‘›)ã‚’ç”Ÿæˆã™ã‚‹ã€‚
å¯¾ç…§å­¦ç¿’ã§ã¯ã€Triplet Margin Loss2ï¼‰[14]ã‚’ç”¨ã„ã¦ã€ä»¥ä¸‹ã®æå¤±é–¢æ•°ã‚’æœ€å°åŒ–ã™ã‚‹ã€‚
ğ¿ = max{âˆ¥ğ¸ğ‘âˆ’ ğ¸ğ‘âˆ¥2âˆ’ âˆ¥ğ¸ğ‘âˆ’ ğ¸ğ‘›âˆ¥2+ ğ›¼, 0}ã“ã“ã§ ğ›¼ ã¯ãƒãƒ¼ã‚¸ãƒ³ï¼ˆãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰ã§ã‚ã‚‹ã€‚
ã“ã®å­¦ç¿’ã«ã‚ˆã£ã¦ã€åŒä¸€å¯¾è©±å†…ã®ã‚¢ãƒ³ã‚«ãƒ¼ã¨æ­£ä¾‹ã®åŸ‹ã‚è¾¼ã¿ãŒè¿‘ããªã‚‹ä¸€æ–¹ã€è² ä¾‹ã®åŸ‹ã‚è¾¼ã¿ã¯é ã–ã‹ã‚‹ã‚ˆã†ã«èª¿æ•´ã•ã‚Œã‚‹ã€‚
åŒä¸€å¯¾è©±å†…ã§æ­£ä¾‹ã¨è² ä¾‹ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã§ã€å¯¾è©±å†…å®¹ã®å½±éŸ¿ã‚’æŠ‘ãˆã€è©±ã—æ–¹ã®ç‰¹å¾´ã®ã¿ã‚’æ‰ãˆã‚‹åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚‹ã€‚
ã¾ãŸã€ã“ã®åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’åˆ©ç”¨ã—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€åºç›¤ã®å¯¾è©±ã‹ã‚‰é¡ä¼¼ã—ãŸè©±ã—æ–¹ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ã®çµ‚ç›¤ã®å¯¾è©±ã‚’ç²å¾—ã§ãã‚‹ã¨è€ƒãˆã‚‹ã€‚

4 å®Ÿé¨“



4.1 å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ

åˆå¯¾é¢ã®å¯¾è©±ã‹ã‚‰å§‹ã¾ã‚Šã€å¾ã€…ã«ç›¸æ‰‹ã«é©å¿œã—ã¦ã„ãæ§˜å­ãŒè¨˜éŒ²ã•ã‚ŒãŸå¯¾è©±ãƒ‡ãƒ¼ã‚¿ã‚’å¯¾è±¡ã«å®Ÿé¨“ã‚’è¡Œã£ãŸã€‚
å…·ä½“çš„ã«ã¯ã€æ—…è¡Œä»£ç†åº—ã‚¿ã‚¹ã‚¯å¯¾è©±ã‚³ãƒ¼ãƒ‘ã‚¹ï¼ˆTabidachiï¼‰ [15]ã¨ RealPersonaChat ã‚³ãƒ¼ãƒ‘ã‚¹ï¼ˆRPCï¼‰ [16]ã® 2 ç¨®é¡ã‚’åˆ©ç”¨ã—ãŸã€‚
Tabidachi ã¯ã€è¦³å…‰ãƒ—ãƒ©ãƒ³ã«é–¢ã™ã‚‹ç›¸è«‡ã®å¯¾è©±ã‚’è¨˜éŒ²ã—ãŸéŸ³å£°å¯¾è©±ã®æ›¸ãèµ·ã“ã—ã‚³ãƒ¼ãƒ‘ã‚¹ã§ã‚ã‚‹ã€‚
ã“ã®ã‚³ãƒ¼ãƒ‘ã‚¹ã«ã¯ã€ã‚«ã‚¹ã‚¿ãƒã¨ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã®é–“ã§äº¤ã‚ã•ã‚ŒãŸå¯¾è©±ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã¯ã‚«ã‚¹ã‚¿ãƒã®2ï¼‰ https://pytorch.org/docs/stable/generated/torch.nn.TripletMarginLoss

ç™ºè©±å†…å®¹ã«å¿œã˜ã¦é©å¿œçš„ã«å¯¾è©±ã‚’é€²ã‚ã‚‹ã€‚
ã‚«ã‚¹ã‚¿ãƒå½¹ã¯ã€ä¸€èˆ¬ 25 åã€é«˜é½¢è€… 10 åã€å­ä¾› 20 åã§æ§‹æˆã•ã‚Œã€åˆè¨ˆã§ 55 ãƒšã‚¢ã®å¯¾è©±ãŒåéŒ²ã•ã‚Œã¦ã„ã‚‹ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€ã‚³ãƒ¼ãƒ‘ã‚¹ä¸­ã®ãƒšã‚¢ã‚’ trainï¼Œvalidationï¼Œtestã« 45:5:5 ã®å‰²åˆã§åˆ†å‰²ã—ã¦ä½¿ç”¨ã—ãŸã€‚
RPC ã¯ã€è©±è€…ã®ãƒšãƒ«ã‚½ãƒŠã‚„æ€§æ ¼ç‰¹æ€§ã‚’å«ã‚€é›‘è«‡å¯¾è©±ã‚’è¨˜éŒ²ã—ãŸãƒ†ã‚­ã‚¹ãƒˆå¯¾è©±ã‚³ãƒ¼ãƒ‘ã‚¹ã§ã‚ã‚‹ã€‚
ã“ã®ã‚³ãƒ¼ãƒ‘ã‚¹ã«ã¯ã€233 äººã®å‚åŠ è€…ã«ã‚ˆã‚‹åˆè¨ˆ 1572 ãƒšã‚¢ã®å¯¾è©±ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã€‚
è©±è€…ã®å¹´é½¢æ§‹æˆã¯ã€20 ä»£ã€30 ä»£ã€40 ä»£ãŒãã‚Œãã‚Œç´„ 30%ã‚’å ã‚ã€å¹…åºƒã„è©±è€…å±¤ã®å¤šæ§˜ãªå¯¾è©±ãŒåéŒ²ã•ã‚Œã¦ã„ã‚‹ã€‚
RPC ã®åé›†ã«ã¯å¯¾è©±ç›¸æ‰‹ã«é©å¿œçš„ã«é€²ã‚ã‚‹ã¨ã„ã†æ„å›³ã¯å«ã¾ã‚Œã¦ã„ãªã„ãŒã€åéŒ²ã•ã‚ŒãŸå¯¾è©±ãŒåˆå¯¾é¢ã®è©±è€…åŒå£«ã§è¡Œã‚ã‚Œã¦ã„ã‚‹ç‚¹ã«ç€ç›®ã—ã¦æ¡ç”¨ã—ãŸã€‚
åˆå¯¾é¢ã‹ã‚‰å¾ã€…ã«ç›¸æ‰‹ã«åˆã‚ã›ã¦ã„ãè©±ã—æ–¹ã®å¤‰åŒ–ã‚’æ‰ãˆã‚‹ãŸã‚ã€æœ¬ç ”ç©¶ã«ãŠã„ã¦é©ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã‚ã‚‹ã¨åˆ¤æ–­ã—ãŸã€‚
åŒæ§˜ã«ã€ã‚³ãƒ¼ãƒ‘ã‚¹ä¸­ã®ãƒšã‚¢ã‚’ trainï¼Œvalidationï¼Œtest ã« 1272:150:150 ã®å‰²åˆã§åˆ†å‰²ã—ã¦ä½¿ç”¨ã—ãŸã€‚
å®Ÿé¨“ã§ã¯ã€å„å¯¾è©±ã‹ã‚‰ã‚¢ãƒ³ã‚«ãƒ¼ 5 å€‹ã€æ­£ä¾‹ 5 å€‹ã€è² ä¾‹ 5 å€‹ã‚’çª“å¹… ğ‘› ã‚’ãšã‚‰ã—ãªãŒã‚‰æŠ½å‡ºã—ãŸã€‚
å…·ä½“çš„ã«ã¯ã€ğ·ğ‘ ğ‘¡ ğ‘ğ‘Ÿğ‘¡ï¼Œğ·ğ‘’ğ‘›ğ‘‘ï¼Œğ·ğ‘šğ‘–ğ‘‘ğ‘‘ğ‘™ğ‘’ã‹ã‚‰ãã‚Œãã‚Œç™ºè©±é›†åˆã‚’å–ã‚Šå‡ºã—ã€ãã‚Œã‚‰ã®ç™ºè©±ã‚’ç‰¹æ®Šãƒˆãƒ¼ã‚¯ãƒ³[ğ‘†ğ¸ ğ‘ƒ]ã§é€£çµã—ãŸã€‚
çª“å¹… ğ‘› ã¯ Tabidachi ã§ã¯ 5 ã¨ 10 ã® 2 ç¨®é¡ã‚’ç”¨ã„ã€RPC ã§ã¯çª“å¹… 5 ã®ã¿ã‚’ç”¨ã„ãŸã€‚
ã“ã®è¨­å®šã¯ï¼ŒRPC ã® 1 å¯¾è©±ã‚ãŸã‚Šã®ç™ºè©±æ•°ãŒç´„ 30 ç™ºè©±ç¨‹åº¦ã§ã‚ã‚Šã€çª“å¹…ã‚’åºƒã’ã‚‹ã¨å¤šæ§˜ãªãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒå›°é›£ãªãŸã‚ã§ã‚ã‚‹ã€‚
ä¸€æ–¹ã€Tabidachi ã¯ 1 å¯¾è©±ã‚ãŸã‚Šã®ç™ºè©±æ•°ãŒç´„ 360 ç™ºè©±ã¨å¤šãã®ç™ºè©±ãŒåéŒ²ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€çª“å¹… 10 ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§å¤šæ§˜æ€§ã®ã‚ã‚‹å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆå¯èƒ½ã§ã‚ã£ãŸã€‚
çµæœã¨ã—ã¦ã€1å¯¾è©±ã‚ãŸã‚Šåˆè¨ˆ 125 å€‹ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ãŸã€‚



4.2 ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’

æœ¬ç ”ç©¶ã§ã¯ã€ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦æ±åŒ—å¤§å­¦ãŒå…¬é–‹ã—ã¦ã„ã‚‹æ—¥æœ¬èª ğµğ¸ ğ‘…ğ‘‡ğ‘ğ‘ğ‘ ğ‘’3ï¼‰[17]ã‚’ä½¿ç”¨ã—ãŸã€‚
ã“ã®ãƒ¢ãƒ‡ãƒ«ã¯ã€æ—¥æœ¬èªã«ç‰¹åŒ–ã—ãŸäº‹å‰å­¦ç¿’æ¸ˆã¿ã® BERTãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚Šã€æ—¥æœ¬èªã®æ–‡è„ˆæƒ…å ±ã‚’åŠ¹æœçš„ã«æ‰ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
ã¾ãŸã€ã“ã®ãƒ¢ãƒ‡ãƒ«ã¯ææ¡ˆãƒ¢ãƒ‡ãƒ«ã®åŸºç›¤ã¨ãªã‚‹ã ã‘ã§ãªãã€æ¯”è¼ƒãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ã‚‚ä½¿ç”¨ã—ãŸã€‚
åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ã§ã¯ã€ã“ã®ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åˆæœŸå€¤ã¨ã—ã¦åˆ©ç”¨ã—ã€ææ¡ˆæ‰‹æ³•ã«åŸºã¥ã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¯¾ã™ã‚‹å¯¾ç…§å­¦ç¿’ã‚’è¡Œã£ãŸã€‚
å…·ä½“3ï¼‰ https://huggingface.co/tohoku-nlp/bert-base-japanese-v3çš„ã«ã¯ã€å¯¾è©±ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã‚¢ãƒ³ã‚«ãƒ¼ã€æ­£ä¾‹ã€è² ä¾‹ã‚’æŠ½å‡ºã—ã€Triplet Margin Loss ã‚’ä½¿ç”¨ã—ã¦å­¦ç¿’ã‚’é€²ã‚ãŸã€‚
å­¦ç¿’æ™‚ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ã¯ã€ãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’ 64ã€ã‚ªãƒ—ãƒ†ã‚£ãƒã‚¤ã‚¶ã«ã¯ AdamW ã‚’é¸æŠã—ã€å­¦ç¿’ç‡ã¯ 1e-05 ã«è¨­å®šã—ãŸã€‚
ã¾ãŸã€Triplet Margin Lossã®ãƒãƒ¼ã‚¸ãƒ³ã¯ 1 ã¨ã—ãŸã€‚
ã•ã‚‰ã«ã€æ¯”è¼ƒãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ï¼ˆFT ãƒ¢ãƒ‡ãƒ«ï¼‰ã‚’æ§‹ç¯‰ã—ãŸã€‚
ã“ã®ãƒ¢ãƒ‡ãƒ«ã¯ã€ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ‡ãƒ¼ã‚¿é‡ãŒæ¯”è¼ƒçš„å¤šã„ RPC ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§äº‹å‰å­¦ç¿’ã—ãŸå¾Œã€Tabidachi ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§è¿½åŠ å­¦ç¿’ã‚’è¡Œã£ãŸã‚‚ã®ã§ã‚ã‚‹ã€‚
ã“ã®äºŒæ®µéšå­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ˆã‚Šã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿é‡ãŒå¢—åŠ ã—ã€åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã®è¡¨ç¾åŠ›ã‚„æ€§èƒ½ã®å‘ä¸ŠãŒæœŸå¾…ã•ã‚Œã‚‹ã€‚

4.3 è©•ä¾¡

ç”Ÿæˆã•ã‚ŒãŸåŸ‹ã‚è¾¼ã¿ã®æœ‰åŠ¹æ€§ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«Cosine Similarity ã‚’ç”¨ã„ãŸè©•ä¾¡ã‚’è¨­è¨ˆã—ãŸã€‚
å…·ä½“çš„ã«ã¯ã€åŸ‹ã‚è¾¼ã¿ãƒ™ã‚¯ãƒˆãƒ«é–“ã®ã‚³ã‚µã‚¤ãƒ³é¡ä¼¼åº¦(ğ‘ğ‘œğ‘ )ã‚’ç”¨ã„ã¦ã€ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã™ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å‰²åˆğ‘ƒ ã‚’ç²¾åº¦ã¨ã—ã¦è¨ˆç®—ã—ãŸã€‚
ğ‘ƒ =å€‹æ•°(cos(ğ¸ğ‘, ğ¸ğ‘) > cos(ğ¸ğ‘, ğ¸ğ‘›))ç·ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ•°ã“ã“ã§ã€ğ¸ğ‘ã¯å¯¾è©±åºç›¤ã®ã‚¢ãƒ³ã‚«ãƒ¼ã®åŸ‹ã‚è¾¼ã¿ã€ğ¸ğ‘ã¯å¯¾è©±çµ‚ç›¤ã®æ­£ä¾‹ã®åŸ‹ã‚è¾¼ã¿ã€ğ¸ğ‘›ã¯å¯¾è©±ä¸­ç›¤ã®è² ä¾‹ã®åŸ‹ã‚è¾¼ã¿ã‚’è¡¨ã™ã€‚
ã“ã®è©•ä¾¡æŒ‡æ¨™ã«ã‚ˆã£ã¦ã€åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ãŒå¯¾è©±å†…å®¹ã§ã¯ãªãã€çµ‚ç›¤ã®è©±ã—æ–¹ã‚„ç™ºè©±ã‚¹ã‚¿ã‚¤ãƒ«ã«åŸºã¥ã„ãŸç‰¹å¾´ã‚’æ‰ãˆã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚
ä»®ã«ãƒ¢ãƒ‡ãƒ«ãŒå¯¾è©±ã®å†…å®¹ã«ä¾å­˜ã—ã¦åŸ‹ã‚è¾¼ã¿ã‚’ä½œæˆã—ã¦ã„ã‚‹å ´åˆã€æ­£ä¾‹(ğ¸ğ‘)ã¨è² ä¾‹(ğ¸ğ‘›)ã®é–“ã§é¡ä¼¼åº¦ãŒã»ã¼åŒã˜ã«ãªã‚‹ã¨æƒ³å®šã•ã‚Œã‚‹ã€‚
ã“ã‚Œã¯ã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’åŒã˜å¯¾è©±ã®ä¸­ã‹ã‚‰ä½œæˆã—ã¦ã„ã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚
ä¸€æ–¹ã€è©±ã—æ–¹ã‚„ç™ºè©±ã‚¹ã‚¿ã‚¤ãƒ«ã«ç€ç›®ã—ãŸåŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ãŒé©åˆ‡ã«æ©Ÿèƒ½ã—ã¦ã„ã‚‹å ´åˆã€æ­£ä¾‹(ğ¸ğ‘)ã¯ã‚¢ãƒ³ã‚«ãƒ¼(ğ¸ğ‘)ã¨é¡ä¼¼æ€§ãŒé«˜ãã€è² ä¾‹(ğ¸ğ‘›)ã¨ã¯é¡ä¼¼æ€§ãŒä½ããªã‚‹ã¨æœŸå¾…ã•ã‚Œã‚‹ã€‚
ç‰¹ã«ã€ææ¡ˆãƒ¢ãƒ‡ãƒ«ã§ã¯ã€å¯¾è©±å†…å®¹ã«ä¾å­˜ã›ãšã«è©±ã—æ–¹ã‚„ç™ºè©±ã‚¹ã‚¿ã‚¤ãƒ«ã‚’åŸ‹ã‚è¾¼ã¿ç©ºé–“ä¸Šã§åæ˜ ã™ã‚‹ã“ã¨ã§ã€æ­£ä¾‹ã¨ã‚¢ãƒ³ã‚«ãƒ¼ã®ã‚³ã‚µã‚¤ãƒ³é¡ä¼¼åº¦(cos(ğ¸ğ‘, ğ¸ğ‘))ãŒè² ä¾‹ã¨ã®é¡ä¼¼åº¦(cos(ğ¸ğ‘, ğ¸ğ‘›))ã‚’å¤§ããä¸Šå›ã‚‹çµæœãŒå¾—ã‚‰ã‚Œã‚‹ã¨äºˆæƒ³ã•ã‚Œã‚‹ã€‚

è¡¨ 1 Tabidachi ã«ãŠã‘ã‚‹ Cosine Similarity è©•ä¾¡ã®çµæœã€‚
ãã‚Œãã‚Œã®çª“å¹…(ğ‘›)ã«ãŠã„ã¦æœ€ã‚‚é«˜ã„ã‚¹ã‚³ã‚¢ã‚’å¤ªå­—ã§è¡¨ã™ã€‚
çª“å¹…(ğ‘›)ãƒ¢ãƒ‡ãƒ«ç²¾åº¦(%)5 æ¯”è¼ƒãƒ¢ãƒ‡ãƒ« 53.4ææ¡ˆãƒ¢ãƒ‡ãƒ« 55.5FT ãƒ¢ãƒ‡ãƒ« 51.410 æ¯”è¼ƒãƒ¢ãƒ‡ãƒ« 58.7ææ¡ˆãƒ¢ãƒ‡ãƒ« 71.2FT ãƒ¢ãƒ‡ãƒ« 63.0è¡¨ 2 RPC ã«ãŠã‘ã‚‹ Cosine Similarity è©•ä¾¡ã®çµæœã€‚
æœ€ã‚‚é«˜ã„ã‚¹ã‚³ã‚¢ã‚’å¤ªå­—ã§è¡¨ã™ã€‚
çª“å¹…(ğ‘›)ãƒ¢ãƒ‡ãƒ«ç²¾åº¦(%)5 æ¯”è¼ƒãƒ¢ãƒ‡ãƒ« 49.4ææ¡ˆãƒ¢ãƒ‡ãƒ« 61.5

4.4 çµæœ

Tabidachi ãŠã‚ˆã³ RPC ã‚’ç”¨ã„ã¦ææ¡ˆãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’è©•ä¾¡ã—ãŸã€‚
è¡¨ 1 ã«ã€Tabidachi ã‚’ç”¨ã„ãŸå®Ÿé¨“çµæœã‚’ç¤ºã™ã€‚
çª“å¹… 5 ã§ã¯ 55.5%ã€çª“å¹… 10 ã§ã¯ 71.2%ã®ç²¾åº¦ã‚’é”æˆã—ã€ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã«æ¯”ã¹ã¦ãã‚Œãã‚Œ 2.1 ãƒã‚¤ãƒ³ãƒˆã€12.5 ãƒã‚¤ãƒ³ãƒˆã®æ”¹å–„ã‚’ç¢ºèªã§ããŸã€‚
çª“å¹…ã‚’å¤§ããã™ã‚‹ã“ã¨ã§ç²¾åº¦ãŒå‘ä¸Šã™ã‚‹å‚¾å‘ãŒè¦‹ã‚‰ã‚Œã€é•·ã„æ–‡è„ˆã‚’å–ã‚Šè¾¼ã‚€ã“ã¨ã§å¯¾ç…§å­¦ç¿’ã®åŠ¹æœãŒã‚ˆã‚Šé¡•è‘—ã«ç¾ã‚Œã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹ã€‚
ä¸€æ–¹ã§ FT ãƒ¢ãƒ‡ãƒ«ã¯ RPC ã§ã®äº‹å‰å­¦ç¿’ã‚’è¡Œã£ãŸã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ææ¡ˆãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šã‚‚ä½ã„ç²¾åº¦ã¨ãªã£ãŸã€‚
ã“ã‚Œã¯ã€RPC ãŒä¸»ã«ãƒ†ã‚­ã‚¹ãƒˆå¯¾è©±ã§é•·ã„å¿œç­”ãŒç‰¹å¾´ã§ã‚ã‚‹ã®ã«å¯¾ã—ã€Tabidachi ã¯éŸ³å£°å¯¾è©±ã§ç›¸æ§Œãªã©çŸ­ã„å¿œç­”ã‚’å«ã‚€ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆé–“ã®ç‰¹æ€§ã®é•ã„ãŒã€é©å¿œã‚’é›£ã—ãã—ãŸã“ã¨ã®åŸå› ã¨è€ƒãˆã‚‰ã‚Œã‚‹ã€‚
è¡¨ 2 ã«ã€RPC ã‚’ç”¨ã„ãŸå®Ÿé¨“çµæœã‚’ç¤ºã™ã€‚
ææ¡ˆãƒ¢ãƒ‡ãƒ«ã§ã¯ 61.5%ã®ç²¾åº¦ã‚’é”æˆã—ã€æ¯”è¼ƒãƒ¢ãƒ‡ãƒ«ã«æ¯”ã¹ã¦ç´„ 12 ãƒã‚¤ãƒ³ãƒˆã®æ”¹å–„ã‚’ç¢ºèªã§ããŸã€‚
ã“ã®çµæœã¯ã€ææ¡ˆãƒ¢ãƒ‡ãƒ«ãŒç™ºè©±ã®å†…å®¹ã§ã¯ãªãã€è©±ã—æ–¹ã«ç€ç›®ã—ãŸåŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆã§ãã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºå”†ã—ã¦ã„ã‚‹ã€‚



4.5 æ¤œç´¢ã®äº‹ä¾‹

æœ¬ç ”ç©¶ã§ã¯ã€æ§‹ç¯‰ã—ãŸåŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã¦ã€åºç›¤ã®å¯¾è©±ã‹ã‚‰é¡ä¼¼ã—ãŸè©±ã—æ–¹ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ã®çµ‚ç›¤ã®å¯¾è©±ã‚’æ¤œç´¢ã™ã‚‹ä»•çµ„ã¿ã‚’æ§‹ç¯‰ã—ãŸã€‚
æ¤œç´¢ã«ã¯ã€Faiss [11]ã‚’åˆ©ç”¨ã—ãŸè¿‘ä¼¼æœ€è¿‘å‚æ¢ç´¢ã‚’æ¡ç”¨ã—ã€å¯¾è©±ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰é¡ä¼¼ã—ãŸè©±ã—æ–¹ã‚’æŒã¤å¯¾è©±ã‚’æ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ã—ãŸã€‚
Tabidachi ã‚³ãƒ¼ãƒ‘ã‚¹ã«å«ã¾ã‚Œã‚‹å­ä¾›ï¼ˆ8 æ­³ï¼‰ã®åºç›¤ã®å¯¾è©±ã‚’æ¤œç´¢ã‚¯ã‚¨ãƒªã¨ã—ã¦ä½¿ç”¨ã—ãŸæ¤œç´¢äº‹ä¾‹ã‚’è¡¨ 3 ã«ç¤ºã™ã€‚
ã“ã®çµæœã¯ã€æ¤œç´¢ã‚¯ã‚¨ãƒªã¨ã—ã¦ä¸ãˆãŸ 8 æ­³ã®å­ä¾›ã®è©±ã—æ–¹ã«è¿‘ã„ 10 æ­³ã®å­è¡¨ 3 æ¤œç´¢ã®äº‹ä¾‹ã‚¯ã‚¨ãƒªï¼šå­ä¾›ã®å¯¾è©±ï¼ˆ8 æ­³ã€å¯¾è©± ID: 306_1_1ï¼‰<ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>ã“ã‚“ã«ã¡ã¯ã€‚
[SEP] <ã‚«ã‚¹ã‚¿ãƒ>ã“ã‚“ã«ã¡ã¯ãƒ¼ã€‚
[SEP] <ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>ä»Šæ—¥ã¯ã”åˆ©ç”¨ã„ãŸã ãã¾ã—ã¦ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚
[SEP] <ã‚«ã‚¹ã‚¿ãƒ>ã‚ã€ã“ã¡ã‚‰ã“ãã€‚[SEP] <ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>ã¯ã„ã€ã§ã€ä»Šæ—¥ã¯æ—…è¡Œã®ç›¸è«‡ã§ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ [SEP] <ã‚«ã‚¹ã‚¿ãƒ>ã¯ã„ã€‚
[SEP] <ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>ã¯ã„ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚
ã©ã“ã«æ—…è¡Œã«è¡Œãã‚“ã§ã™ã‹ï¼Ÿ [SEP] <ã‚«ã‚¹ã‚¿ãƒ>åŒ—æµ·é“ã§ã™ã€‚
[SEP] <ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>åŒ—æµ·é“ã§ã™ã­ã€‚
ã„ã„ã§ã™ã­ã€åŒ—æµ·é“ã€‚
åŒ—æµ·é“ã£ã¦è¡Œã£ãŸã“ã¨ã‚ã‚Šã¾ã™ã‹ï¼Ÿ [SEP] <ã‚«ã‚¹ã‚¿ãƒ>ã‚ã€ã¯ã„ã€‚
æ¤œç´¢çµæœï¼šå­ä¾›ã®å¯¾è©±ï¼ˆ10 æ­³ã€å¯¾è©± ID: 310_1_1ï¼‰<ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>ãã£ã‹ã€ã˜ã‚ƒã‚ã€ã“ã‚Œã€ä»Šã­ã€ã‚¹ã‚­ãƒ¼ã‚’ã—ã¾ã™ã£ã¦ã„ã†ã®ã¨ã€é‡£ã‚Šã‚’ã—ã¾ã™ã£ã¦ã„ã†ã®ã¨ã€ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­é£Ÿã¹ã¾ã™ã£ã¦æ±ºã‚ãŸã‚ˆã­ã€‚
[SEP] <ã‚«ã‚¹ã‚¿ãƒ>ã¯ã„ã€‚
[SEP] <ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>ä»–ã€ä½•ã‹ã€ãŠçˆ¶ã•ã‚“ã¨ã‹ãŠæ¯ã•ã‚“ã€ã“ã‚“ãªã“ã¨ã—ãŸã„ã£ã¦è¨€ã£ã¦ãªã‹ã£ãŸï¼Ÿ [SEP] <ã‚«ã‚¹ã‚¿ãƒ>è¨€ã£ã¦ã„ã¾ã›ã‚“ã€‚
[SEP]<ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>è¨€ã£ã¦ã„ã¾ã›ã‚“ã€‚
[SEP] <ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>ã˜ã‚ƒã‚ä»–ã«ã€ãŠå®¢æ§˜è‡ªèº«ãŒä½•ã‹é£Ÿã¹ã¦ã¿ãŸã„ã®ã¨ã‹ã€ãã†ã„ã†ã®ã€æ±ºã‚ã¦ã„ã“ã£ã‹ã€‚
[SEP] <ã‚«ã‚¹ã‚¿ãƒ>ã¯ã„ã€‚
[SEP] <ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>ã©ã†ã—ã‚ˆã†ã€ã˜ã‚ƒã‚ã€ä»–ã€ä½•ã‹ã€é£Ÿã¹ç‰©æ±ºã‚ã‚‹ã®ãŒã„ã„ï¼Ÿãã‚Œã¨ã‚‚è¡Œãå ´æ‰€ãŒã„ã„ï¼Ÿ [SEP] <ã‚ªãƒšãƒ¬ãƒ¼ã‚¿>ã‚¹ã‚­ãƒ¼ã¨ã‹é‡£ã‚Šä»¥å¤–ã€ä½•ã‹ã—ã¦ã¿ãŸã„ï¼Ÿ [SEP] <ã‚«ã‚¹ã‚¿ãƒ>ãŠå¯¿å¸ã§ã‚‚é£Ÿã¹ãŸã„ã€‚
ä¾›ã®å¯¾è©±ãŒæ¤œç´¢ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹ã€‚
æ¤œç´¢çµæœã«å«ã¾ã‚Œã‚‹ç™ºè©±ã§ã¯ã€ã€Œé‡£ã‚Šã‚’ã—ã¾ã™ã£ã¦ã„ã†ã®ã¨ã€ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­é£Ÿã¹ã¾ã™ã£ã¦æ±ºã‚ãŸã‚ˆã­ã€‚
ã€
ã®
ã‚ˆã†ãªå­ä¾›ã«åˆã‚ã›ãŸè¨€è‘‰é£ã„ãŒè¦³å¯Ÿã•ã‚ŒãŸã€‚
ã“ã®ã“ã¨ã‹ã‚‰ã€ææ¡ˆãƒ¢ãƒ‡ãƒ«ã¯è©±ã—æ–¹ã«åŸºã¥ã„ãŸåŸ‹ã‚è¾¼ã¿ã‚’é©åˆ‡ã«å­¦ç¿’ã—ã¦ãŠã‚Šã€ç‰¹å®šã®è©±ã—æ–¹ã«å¯¾å¿œã—ãŸé¡ä¼¼å¯¾è©±ã®æ¤œç´¢ãŒå¯èƒ½ã§ã‚ã‚‹ã“ã¨ãŒç¢ºèªã§ããŸã€‚



5 ãŠã‚ã‚Šã«

æœ¬ç¨¿ã§ã¯ã€åºç›¤ã®å¯¾è©±ã‹ã‚‰ã€ãã®è©±è€…ã¨ã®çµ‚ç›¤ã®å¯¾è©±ã‚’äºˆæ¸¬ã™ã‚‹ãŸã‚ã®åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ãŸã€‚
ãã®çµæœã€å¯¾ç…§å­¦ç¿’ã‚’å°å…¥ã™ã‚‹ã“ã¨ã§ã€çµ‚ç›¤ã®å¯¾è©±ã«å¯¾ã™ã‚‹æ¤œç´¢ã®ç²¾åº¦ã®å‘ä¸Šã‚’ç¢ºèªã—ãŸã€‚
ç‰¹ã«ã€ä¸€ã¤ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã«å«ã‚ã‚‹ç™ºè©±æ•°ã‚’å¢—ã‚„ã—ãŸå ´åˆã«å¤§å¹…ãªç²¾åº¦ã®å‘ä¸ŠãŒè¦‹ã‚‰ã‚Œã€é•·ã„æ–‡è„ˆæƒ…å ±ãŒè©±ã—æ–¹ã®ç‰¹å¾´ã‚’æ‰ãˆã‚‹ä¸Šã§æœ‰åŠ¹ã§ã‚ã‚‹ã“ã¨ãŒç¤ºã•ã‚ŒãŸã€‚
ã¾ãŸã€å¯¾è©±ãƒ‡ãƒ¼ã‚¿ã®ç‰¹å¾´ã«å¿œã˜ã¦åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ãŒå¤‰åŒ–ã™ã‚‹ã“ã¨ãŒæ˜ã‚‰ã‹ã¨ãªã£ãŸã€‚
ä»Šå¾Œã¯ã€æ§‹ç¯‰ã—ãŸåŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«ã‚’ã•ã‚‰ã«ç™ºå±•ã•ã›ã€å®Ÿéš›ã®å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ã«å¿œç”¨ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã™ã€‚
å…·ä½“çš„ã«ã¯ã€Retrieval-Augmented Generationï¼ˆRAGï¼‰ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ[18]ã‚’å‚è€ƒã«ã€æ¤œç´¢ã•ã‚ŒãŸå¯¾è©±ã‚’ã‚·ãƒ§ãƒƒãƒˆã¨ã—ã¦å¿œç­”ç”Ÿæˆã«çµ„ã¿è¾¼ã‚€ã“ã¨ã§ã€å¯¾è©±ç›¸æ‰‹ã®è©±ã—æ–¹ã«é©å¿œã—ãŸç™ºè©±ã®å®Ÿç¾ã‚’ç›®æŒ‡ã™ã€‚
ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚Šã€å¾“æ¥ã®å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ ãŒæŠ±ãˆã¦ã„ãŸã€æœªçŸ¥ã®ãƒ¦ãƒ¼ã‚¶ã¸ã®é©å¿œæ€§ã®èª²é¡Œã‚’å…‹æœã™ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã‚‹ã€‚



è¬è¾

æœ¬ç ”ç©¶ã¯ã€JST ãƒ ãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆå‹ç ”ç©¶é–‹ç™ºäº‹æ¥­ã€JPMJMS2011 ã®æ”¯æ´ã‚’å—ã‘ãŸã€‚ã¾ãŸã€æœ¬ç ”ç©¶ã¯ã€æ ªå¼ä¼šç¤¾ã‚¢ã‚¤ã‚·ãƒ³ã¨ã®å…±åŒç ”ç©¶ã®æˆæœã‚’å«ã‚€ã€‚ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ã«ã¯ã€åå¤å±‹å¤§å­¦ã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã€Œä¸è€ã€ã‚’åˆ©ç”¨ã—ãŸã€‚

å‚è€ƒæ–‡çŒ®


[1] OpenAI. GPT-4 technical report. arXiv preprintarXiv:2303.08774, 2023.
[2] Shinya Iizuka, Shota Mochizuki, Atsumoto Ohashi, SanaeYamashita, Ao Guo, and Ryuichiro Higashinaka. Clarify-ing the dialogue-level performance of GPT-3.5 and GPT-4in task-oriented and non-task-oriented dialogue systems. InProceedings of the AAAI Symposium Series, Vol. 2,pp. 182â€“186, 2023.
[3] Chuyi Kong, Yaxin Fan, Xiang Wan, Feng Jiang, andBenyou Wang. PlatoLM: Teaching LLMs in multi-rounddialogue via a user simulator. In Proceedings of the62nd Annual Meeting of the Association for Com-putational Linguistics (Volume 1: Long Papers), pp.7841â€“7863, 2024.
[4] Kurt Shuster, Jing Xu, Mojtaba Komeili, Da Ju,Eric Michael Smith, Stephen Roller, Megan Ung, MoyaChen, Kushal Arora, Joshua Lane, et al. Blenderbot 3:A deployed conversational agent that continually learns toresponsibly engage. arXiv preprint arXiv:2208.03188,2022.
[5] Kazunori Komatani, Shinichi Ueno, Tatsuya Kawahara,and Hiroshi G. Okuno. Flexible guidance generation usinguser model in spoken dialogue systems. In Proceedingsof the 41st Annual Meeting of the Association forComputational Linguistics, pp. 256â€“263, 2003.
[6] Atsumoto Ohashi and Ryuichiro Higashinaka. Adaptivenatural language generation for task-oriented dialogue viareinforcement learning. In Proceedings of the 29th In-ternational Conference on Computational Linguis-tics, pp. 242â€“252, 2022.
[7] Kenta Yamamoto, Koji Inoue, and Tatsuya Kawahara.Character adaptation of spoken dialogue systems based onuser personalities. In Proceedings of the InternationalWorkshop on Spoken Dialogue System Technology,2023.
[8] Howard Giles, Tania Ogay, et al. Communication accom-modation theory. Explaining communication: Con-temporary theories and exemplars, pp. 293â€“310, 2007.
[9] Kate G Niederhoï¬€er and James W Pennebaker. Linguis-tic style matching in social interaction. Language andSocial Psychology, Vol. 21, No. 4, pp. 337â€“360, 2002.
[10] Ashish Jaiswal, Ashwin Ramesh Babu, Mohammad ZakiZadeh, Debapriya Banerjee, and Fillia Makedon. A surveyon contrastive self-supervised learning. Technologies,Vol. 9, No. 1, p. 2, 2020.
[11] Matthijs Douze, Alexandr Guzhva, Chengqi Deng, Jeï¬€Johnson, Gergely Szilvasy, Pierre-Emmanuel MazarÃ©,Maria Lomeli, Lucas Hosseini, and HervÃ© JÃ©gou. TheFaiss library. arXiv preprint arXiv:2401.08281, 2024.
[12] Reina Akama, Kento Watanabe, Sho Yokoi, SosukeKobayashi, and Kentaro Inui. Unsupervised learning ofstyle-sensitive word vectors. In Proceedings of the56th Annual Meeting of the Association for Com-putational Linguistics (Volume 2: Short Papers),pp. 572â€“578, 2018.
[13] Yuki Zenimoto, Shinzan Komata, and Takehito Utsuro.Style-sensitive sentence embeddings for evaluating simi-larity in speech style of Japanese sentences by contrastivelearning. In Proceedings of the 13th InternationalJoint Conference on Natural Language Processingand the 3rd Conference of the Asia-Paciï¬c Chapterof the Association for Computational Linguistics:Student Research Workshop, pp. 32â€“39, 2023.
[14] Vassileios Balntas, Edgar Riba, Daniel Ponsa, and Krys-tian Mikolajczyk. Learning local feature descriptors withtriplets and shallow convolutional neural networks. In Pro-ceedings of the British Machine Vision Conference,Vol. 1, p. 3, 2016.
[15] Michimasa Inaba, Yuya Chiba, Zhiyang Qi, RyuichiroHigashinaka, Kazunori Komatani, Yusuke Miyao, andTakayuki Nagai. Travel agency task dialogue corpus:A multimodal dataset with age-diverse speakers. ACMTransactions on Asian and Low-Resource LanguageInformation Processing, Vol. 23, No. 9, pp. 1â€“23, 2024.
[16] Sanae Yamashita, Koji Inoue, Ao Guo, Shota Mochizuki,Tatsuya Kawahara, and Ryuichiro Higashinaka. RealPer-sonaChat: A realistic persona chat corpus with interlocu-torsâ€™ own personalities. In Proceedings of the 37thPaciï¬c Asia Conference on Language, Informationand Computation, pp. 852â€“861, 2023.
[17] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and KristinaToutanova. BERT: Pre-training of deep bidirectional trans-formers for language understanding. In Proceedings ofthe North American Chapter of the Association forComputational Linguistics, pp. 4171â€“4186, 2019.
[18] Patrick Lewis, Ethan Perez, Aleksandra Piktus, FabioPetroni, Vladimir Karpukhin, Naman Goyal, Heinrich KÃ¼t-tler, Mike Lewis, Wen tau Yih, Tim RocktÃ¤schel, SebastianRiedel, and Douwe Kiela. Retrieval-Augmented Genera-tion for knowledge-intensive NLP tasks. arXiv preprintarXiv:2005.11401, 2021.