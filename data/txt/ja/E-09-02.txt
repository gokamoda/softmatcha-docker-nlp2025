Cognitive Preference Optimization: è„³æƒ…å ±ã«ã‚ˆã‚‹è¨€èªãƒ¢ãƒ‡ãƒ«ã®é¸å¥½æœ€é©åŒ–

åŸç”°å®¥éƒ½â€ƒå¤§é–¢æ´‹å¹³



æ±äº¬å¤§å­¦



â€ƒ{harada-yuto, oseki}@g.ecc.u-tokyo.ac.jp



æ¦‚è¦

è¿‘å¹´ã®å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½å‘ä¸Šã«ãŠã„ã¦ã€Direct Preference Optimization (DPO)ã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã®æˆåŠŸãŒå¤§ããªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã‚‹ã€‚
ã—ã‹ã—ã€å­¦ç¿’ã§ç”¨ã„ã‚‰ã‚Œã‚‹ãƒ©ãƒ™ãƒ«ã®ä½œæˆã«ã¯å¤šå¤§ãªã‚³ã‚¹ãƒˆãŒå¿…è¦ã§ã‚ã‚Šã€ä½œæ¥­è€…ã®è² æ‹…ã‚‚å¤§ãã„ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€ä½œæ¥­è€…ãŒãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚“ã§ã„ã‚‹éš›ã®è„³æ³¢ã‹ã‚‰é¸å¥½æƒ…å ±ã‚’æŠ½å‡ºã—ã€ãã‚Œã«åŸºã¥ããƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹æ‰‹æ³•ã¨ã—ã¦ Cognitive Preference Optimization (CPO)ã‚’æ–°ãŸã«ææ¡ˆã™ã‚‹ã€‚
CPO ã§ã¯ã€ä½œæ¥­è€…ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚€ã ã‘ã§ãƒ©ãƒ™ãƒ«ã‚’ä½œæˆã§ãã€è² æ‹…ã®è»½æ¸›ãŒæœŸå¾…ã§ãã‚‹ã€‚
äººé–“ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ç”¨ã„ãŸå ´åˆã¨æ¯”è¼ƒã—ã¦ã€æ‰‹æ³•ã®å¦¥å½“æ€§ã‚’æ¤œè¨¼ã—ãŸã€‚


1 ã¯ã˜ã‚ã«

å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã®é–‹ç™ºã«ãŠã„ã¦ã€å®‰å…¨ã§ãƒ¦ãƒ¼ã‚¶ã«å¥½ã¾ã‚Œã‚‹å‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ¢ãƒ‡ãƒ«ãŒäººé–“ã®æ„å›³ã‚„ä¾¡å€¤è¦³ã«æ²¿ã£ã¦å‹•ä½œã™ã‚‹ã‚ˆã†ã«èª¿æ•´ã™ã‚‹ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆãŒä¸å¯æ¬ ã§ã‚ã‚‹ã€‚
äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã«å¯¾ã™ã‚‹äº‹å¾Œå­¦ç¿’ã¨ã—ã¦ã¯ã€Supervised Fine-tuning (SFT)ã‚’è¡Œã„ã€ã•ã‚‰ã«äººé–“ã®é¸å¥½ã‚’å–ã‚Šå…¥ã‚Œã‚‹ Direct Preference Optimization(DPO)[1]ã«ã‚ˆã‚‹æœ€é©åŒ–ã‚’è¡Œã†ã¨ã„ã†æµã‚ŒãŒä¸»æµã§ã‚ã‚Šã€æœ€å…ˆç«¯ã®ãƒ¢ãƒ‡ãƒ«ã§ã‚‚ã“ã‚Œã‚‰ã®æ‰‹æ³•ãŒå¤‰ã‚ã‚‰ãšæ¡ç”¨ã•ã‚Œã¦ã„ã‚‹[2]ã€‚
ã—ã‹ã—ã€DPO ãªã©ã®ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–æ‰‹æ³•ã§å¿…è¦ã¨ã•ã‚Œã‚‹é¸å¥½ãƒ©ãƒ™ãƒ«ã®ä½œæˆã«ã¯å¤§ããªè² æ‹…ãŒä¼´ã„ã€ä½œæ¥­è€…ã®é¸æŠœã‚„æ•™è‚²ã€ä½œæ¥­è€…ã¨ã®ä¿¡é ¼é–¢ä¿‚ã®æ§‹ç¯‰ãªã©ã€é•·æœŸçš„ãªã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ç‚¹ã¯å¤§ããªèª²é¡Œã§ã‚ã‚‹[3]ã€‚
ã“ã®ã‚ˆã†ãªçŠ¶æ³ã‚’è¸ã¾ãˆã€è¿‘å¹´ã§ã¯ AI Feedback[4]ã®ã‚ˆã†ã«ã€å¾“æ¥ã®äººæ‰‹ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è£œå®Œãƒ»ä»£æ›¿ã™ã‚‹æ‰‹æ³•ã‚‚é–‹ç™ºã•ã‚Œã¦ããŸã€‚
æœ¬ç ”ç©¶ã§ã¯ã€ã“ã‚Œã‚‰ã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã®æ ¹å¹¹ã¨ãªã‚‹ã€Œäººé–“ã®é¸å¥½æƒ…å ±ã€ã®å–å¾—æ–¹æ³•ã«ã¤ã„ã¦ã€è„³æ´»å‹•ãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã§ããªã„ã‹ã¨ã„ã†æ–°ãŸãªè¦³ç‚¹ã‹ã‚‰å›³ 1: ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®æ¦‚è¦å›³æ¤œè¨ã‚’è¡Œã†ã€‚
ç‰¹ã«ã€DPO ãªã©ã®ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–æ‰‹æ³•ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã«ãŠã„ã¦ã‚‚ã€è„³æ³¢ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹é¸å¥½æƒ…å ±ã¯ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ã«æ´»ç”¨ã§ãã‚‹ã®ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€DPO ãŒæœ€åˆã«ææ¡ˆã•ã‚ŒãŸéš›ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¿ã‚¹ã‚¯ã®ä¸€ã¤ã§ã‚ã‚‹æ„Ÿæƒ…ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ç”Ÿæˆï¼ˆControlled Sentiment Generationï¼‰ã‚’å¯¾è±¡ã¨ã—ã€è¢«é¨“è€…ãŒãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚“ã§ã„ã‚‹éš›ã«è¨ˆæ¸¬ã•ã‚Œã‚‹è„³æ³¢ã‚’ç”¨ã„ã¦ãƒ¢ãƒ‡ãƒ«ã®é¸å¥½æœ€é©åŒ–ã‚’è¡Œã†æ‰‹æ³•ã¨ã—ã¦ Cognitive Preference Optimization(CPO)ã‚’ææ¡ˆã™ã‚‹ã€‚
CPO ã§ã¯ã€äººé–“ãŒãƒ†ã‚­ã‚¹ãƒˆã«å¯¾ã—ã¦ç›´æ¥ãƒ©ãƒ™ãƒ«ä»˜ã‘ã‚’è¡Œã†ã®ã§ã¯ãªãã€è„³æ³¢è¨ˆæ¸¬ã«ã‚ˆã£ã¦æ¨å®šã•ã‚ŒãŸé¸å¥½æƒ…å ±ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã€å¾“æ¥ã®äººæ‰‹ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã‚‹ï¼ˆå›³ 1ï¼‰ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€å¾“æ¥ã®äººé–“ãŒæ˜ç¤ºçš„ã«ä½œæˆã™ã‚‹ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ã€è„³æ´»å‹•ã‹ã‚‰ä½œæˆã•ã‚Œã‚‹æš—é»™çš„ãªèªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã€äºŒã¤ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ãå­¦ç¿’æ‰‹æ³•ã¨ã®æ¯”è¼ƒã‚’è¡Œã†ã“ã¨ã§ã€ãã®å¦¥å½“æ€§ã‚’æ¤œè¨¼ã—ãŸã€‚
å®Ÿé¨“ã®çµæœã€ææ¡ˆæ‰‹æ³•ã‚’ç”¨ã„ãŸãƒ¢ãƒ‡ãƒ«ã¯ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨æ¯”è¼ƒã—ã¦ã‚ˆã‚Šãƒã‚¸ãƒ†ã‚£ãƒ–ãªå‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–ãŒå¯èƒ½ã§ã‚ã‚‹ã“ã¨ãŒç¤ºã•ã‚ŒãŸã€‚
ã“ã‚Œã‚‰ã®çµæœã¯ã€LLMã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã«ãŠã‘ã‚‹æ–°ãŸãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ç¤ºå”†ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚

Cognitive Preference Optimization: è„³æƒ…å ±ã«ã‚ˆã‚‹è¨€èªãƒ¢ãƒ‡ãƒ«ã®é¸å¥½æœ€é©åŒ–

åŸç”°å®¥éƒ½â€ƒå¤§é–¢æ´‹å¹³



æ±äº¬å¤§å­¦



â€ƒ{harada-yuto, oseki}@g.ecc.u-tokyo.ac.jp



æ¦‚è¦

è¿‘å¹´ã®å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½å‘ä¸Šã«ãŠã„ã¦ã€Direct Preference Optimization (DPO)ã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã®æˆåŠŸãŒå¤§ããªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã‚‹ã€‚
ã—ã‹ã—ã€å­¦ç¿’ã§ç”¨ã„ã‚‰ã‚Œã‚‹ãƒ©ãƒ™ãƒ«ã®ä½œæˆã«ã¯å¤šå¤§ãªã‚³ã‚¹ãƒˆãŒå¿…è¦ã§ã‚ã‚Šã€ä½œæ¥­è€…ã®è² æ‹…ã‚‚å¤§ãã„ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€ä½œæ¥­è€…ãŒãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚“ã§ã„ã‚‹éš›ã®è„³æ³¢ã‹ã‚‰é¸å¥½æƒ…å ±ã‚’æŠ½å‡ºã—ã€ãã‚Œã«åŸºã¥ããƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹æ‰‹æ³•ã¨ã—ã¦ Cognitive Preference Optimization (CPO)ã‚’æ–°ãŸã«ææ¡ˆã™ã‚‹ã€‚
CPO ã§ã¯ã€ä½œæ¥­è€…ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚€ã ã‘ã§ãƒ©ãƒ™ãƒ«ã‚’ä½œæˆã§ãã€è² æ‹…ã®è»½æ¸›ãŒæœŸå¾…ã§ãã‚‹ã€‚
äººé–“ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ç”¨ã„ãŸå ´åˆã¨æ¯”è¼ƒã—ã¦ã€æ‰‹æ³•ã®å¦¥å½“æ€§ã‚’æ¤œè¨¼ã—ãŸã€‚


1 ã¯ã˜ã‚ã«

å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã®é–‹ç™ºã«ãŠã„ã¦ã€å®‰å…¨ã§ãƒ¦ãƒ¼ã‚¶ã«å¥½ã¾ã‚Œã‚‹å‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ¢ãƒ‡ãƒ«ãŒäººé–“ã®æ„å›³ã‚„ä¾¡å€¤è¦³ã«æ²¿ã£ã¦å‹•ä½œã™ã‚‹ã‚ˆã†ã«èª¿æ•´ã™ã‚‹ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆãŒä¸å¯æ¬ ã§ã‚ã‚‹ã€‚
äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã«å¯¾ã™ã‚‹äº‹å¾Œå­¦ç¿’ã¨ã—ã¦ã¯ã€Supervised Fine-tuning (SFT)ã‚’è¡Œã„ã€ã•ã‚‰ã«äººé–“ã®é¸å¥½ã‚’å–ã‚Šå…¥ã‚Œã‚‹ Direct Preference Optimization(DPO)[1]ã«ã‚ˆã‚‹æœ€é©åŒ–ã‚’è¡Œã†ã¨ã„ã†æµã‚ŒãŒä¸»æµã§ã‚ã‚Šã€æœ€å…ˆç«¯ã®ãƒ¢ãƒ‡ãƒ«ã§ã‚‚ã“ã‚Œã‚‰ã®æ‰‹æ³•ãŒå¤‰ã‚ã‚‰ãšæ¡ç”¨ã•ã‚Œã¦ã„ã‚‹[2]ã€‚
ã—ã‹ã—ã€DPO ãªã©ã®ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–æ‰‹æ³•ã§å¿…è¦ã¨ã•ã‚Œã‚‹é¸å¥½ãƒ©ãƒ™ãƒ«ã®ä½œæˆã«ã¯å¤§ããªè² æ‹…ãŒä¼´ã„ã€ä½œæ¥­è€…ã®é¸æŠœã‚„æ•™è‚²ã€ä½œæ¥­è€…ã¨ã®ä¿¡é ¼é–¢ä¿‚ã®æ§‹ç¯‰ãªã©ã€é•·æœŸçš„ãªã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ç‚¹ã¯å¤§ããªèª²é¡Œã§ã‚ã‚‹[3]ã€‚
ã“ã®ã‚ˆã†ãªçŠ¶æ³ã‚’è¸ã¾ãˆã€è¿‘å¹´ã§ã¯ AI Feedback[4]ã®ã‚ˆã†ã«ã€å¾“æ¥ã®äººæ‰‹ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è£œå®Œãƒ»ä»£æ›¿ã™ã‚‹æ‰‹æ³•ã‚‚é–‹ç™ºã•ã‚Œã¦ããŸã€‚
æœ¬ç ”ç©¶ã§ã¯ã€ã“ã‚Œã‚‰ã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã®æ ¹å¹¹ã¨ãªã‚‹ã€Œäººé–“ã®é¸å¥½æƒ…å ±ã€ã®å–å¾—æ–¹æ³•ã«ã¤ã„ã¦ã€è„³æ´»å‹•ãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã§ããªã„ã‹ã¨ã„ã†æ–°ãŸãªè¦³ç‚¹ã‹ã‚‰å›³ 1: ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®æ¦‚è¦å›³æ¤œè¨ã‚’è¡Œã†ã€‚
ç‰¹ã«ã€DPO ãªã©ã®ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–æ‰‹æ³•ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã«ãŠã„ã¦ã‚‚ã€è„³æ³¢ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹é¸å¥½æƒ…å ±ã¯ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ã«æ´»ç”¨ã§ãã‚‹ã®ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€DPO ãŒæœ€åˆã«ææ¡ˆã•ã‚ŒãŸéš›ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¿ã‚¹ã‚¯ã®ä¸€ã¤ã§ã‚ã‚‹æ„Ÿæƒ…ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ç”Ÿæˆï¼ˆControlled Sentiment Generationï¼‰ã‚’å¯¾è±¡ã¨ã—ã€è¢«é¨“è€…ãŒãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚“ã§ã„ã‚‹éš›ã«è¨ˆæ¸¬ã•ã‚Œã‚‹è„³æ³¢ã‚’ç”¨ã„ã¦ãƒ¢ãƒ‡ãƒ«ã®é¸å¥½æœ€é©åŒ–ã‚’è¡Œã†æ‰‹æ³•ã¨ã—ã¦ Cognitive Preference Optimization(CPO)ã‚’ææ¡ˆã™ã‚‹ã€‚
CPO ã§ã¯ã€äººé–“ãŒãƒ†ã‚­ã‚¹ãƒˆã«å¯¾ã—ã¦ç›´æ¥ãƒ©ãƒ™ãƒ«ä»˜ã‘ã‚’è¡Œã†ã®ã§ã¯ãªãã€è„³æ³¢è¨ˆæ¸¬ã«ã‚ˆã£ã¦æ¨å®šã•ã‚ŒãŸé¸å¥½æƒ…å ±ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã€å¾“æ¥ã®äººæ‰‹ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã‚‹ï¼ˆå›³ 1ï¼‰ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€å¾“æ¥ã®äººé–“ãŒæ˜ç¤ºçš„ã«ä½œæˆã™ã‚‹ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ã€è„³æ´»å‹•ã‹ã‚‰ä½œæˆã•ã‚Œã‚‹æš—é»™çš„ãªèªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã€äºŒã¤ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ãå­¦ç¿’æ‰‹æ³•ã¨ã®æ¯”è¼ƒã‚’è¡Œã†ã“ã¨ã§ã€ãã®å¦¥å½“æ€§ã‚’æ¤œè¨¼ã—ãŸã€‚
å®Ÿé¨“ã®çµæœã€ææ¡ˆæ‰‹æ³•ã‚’ç”¨ã„ãŸãƒ¢ãƒ‡ãƒ«ã¯ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨æ¯”è¼ƒã—ã¦ã‚ˆã‚Šãƒã‚¸ãƒ†ã‚£ãƒ–ãªå‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–ãŒå¯èƒ½ã§ã‚ã‚‹ã“ã¨ãŒç¤ºã•ã‚ŒãŸã€‚
ã“ã‚Œã‚‰ã®çµæœã¯ã€LLMã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã«ãŠã‘ã‚‹æ–°ãŸãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ç¤ºå”†ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚


2 é–¢é€£ç ”ç©¶

è‡ªç„¶è¨€èªå‡¦ç†ã«ãŠã„ã¦ã€äººé–“ã®ç”Ÿç†çš„ãªæƒ…å ±ã‚’æ´»ç”¨ã—ã¦ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’å‘ä¸Šã•ã›ã‚ˆã†ã¨ã™ã‚‹ç ”ç©¶ã¯ Cognitively Inspired NLP ã¨å‘¼ã°ã‚Œã‚‹åˆ†é‡ã¨ã—ã¦æ•°å¤šãå ±å‘Šã•ã‚Œã¦ã„ã‚‹ã€‚
ã“ã‚Œã‚‰ã®ç ”ç©¶ã§ã¯ã€è„³æ³¢ã‚„è¦–ç·šãªã©ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹äººé–“ã®ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã•ã¾ã–ã¾ãªä¸‹æµã‚¿ã‚¹ã‚¯ã«ãŠã„ã¦æ€§èƒ½æ”¹å–„ãŒå¾—ã‚‰ã‚Œã‚‹ã“ã¨ãŒç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€å“è©è§£æ[5]ã€ä¾å­˜æ§‹é€ è§£æ[6]ã€æ„Ÿæƒ…åˆ†æ[7]ã€å›ºæœ‰è¡¨ç¾èªè­˜[8, 9]ã€é–¢ä¿‚æŠ½å‡º[10]ãªã©éå¸¸ã«å¹…åºƒã„ã‚¿ã‚¹ã‚¯ã«é©ç”¨ã•ã‚Œã¦ãŠã‚Šã€ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹è£œåŠ©æƒ…å ±ã¯ã‚¿ã‚¹ã‚¯ã«ä¾å­˜ã›ãšæœ‰ç›ŠãªåŠ¹æœã‚’ã‚‚ãŸã‚‰ã™ã“ã¨ãŒç¤ºå”†ã•ã‚Œã¦ã„ã‚‹ã€‚
ä¸€æ–¹ã§ã€ã“ã‚Œã‚‰ã®ç ”ç©¶ã®å¤šãã¯ LSTM ãƒ™ãƒ¼ã‚¹ã®ãƒ¢ãƒ‡ãƒ«ã‚’å¯¾è±¡ã¨ã—ã¦ã„ã‚‹ã€‚
è¿‘å¹´ä¸»æµã¨ãªã£ã¦ã„ã‚‹ Transformer ãƒ™ãƒ¼ã‚¹ã®å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã¸ã®é©ç”¨ä¾‹ã¯é™å®šçš„ã§ã‚ã‚‹ã†ãˆã€é©ç”¨ã®ãŸã‚ã«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å¤‰æ›´ãŒå¿…è¦[11]ã§ã‚ã‚Šã€æ—¢å­˜ã®äº‹å‰å­¦ç¿’æ¸ˆãƒ¢ãƒ‡ãƒ«ã‚’æ´»ç”¨ã§ããªã„ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç›´æ¥å¤‰æ›´ã™ã‚‹ã“ã¨ãªãã€äººé–“ã®ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰é¸å¥½æƒ…å ±ã‚’ä½œæˆã™ã‚‹æ‰‹æ³•ã‚’ææ¡ˆã™ã‚‹ã€‚
äº‹å¾Œå­¦ç¿’ã®æ®µéšã§ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€æ—¢å­˜ã®å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã«ã‚‚é©ç”¨å¯èƒ½ãªæ‰‹æ³•ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã‚‹ã€‚


3 æ‰‹æ³•



3.1 Cognitive Preference Optimization

æ‰‹æ³•å…¨ä½“ã®æµã‚Œã‚’å›³ 2 ã«ç¤ºã™ã€‚
Step1: è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®å­¦ç¿’ã¾ãšã€ã‚ã‚‹æ–‡æ›¸ã‚’èª­ã‚“ã§ã„ã‚‹éš›ã® EEG ç‰¹å¾´ç³»åˆ—ã‚’ ğ‘¿ =(ğ’™1, ğ’™2, . . . , ğ’™ğ‘‡)ã¨è¡¨ã—ã€å„ ğ’™ğ‘¡âˆˆ â„ğ‘šã¯æ–‡æ›¸ä¸­ã®å˜èª ğ‘¡ ã«å¯¾å¿œã™ã‚‹ EEG ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã¨ã™ã‚‹ã€‚
æ–‡æ›¸ã®å˜èªæ•°ã‚’ ğ‘‡ ã¨ã™ã‚‹ã€‚
è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã¯ã“ã® EEG ç³»åˆ—ã‚’å…¥åŠ›ã¨ã—ã€ã‚¹ã‚«ãƒ©ãƒ¼å€¤ã‚’å‡ºåŠ›ã™ã‚‹é–¢æ•° ğ‘ ğœ™( ğ‘¿) âˆˆ â„ ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚
ã“ã“ã§ã€ğœ™ ã¯ãƒ‡ã‚³ãƒ¼ãƒ€ã®å­¦ç¿’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚ã‚‹ã€‚
å­¦ç¿’ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦ã€ã€Œå¥½ã¾ã—ã„(chosen)ã€ã¨ã€Œå¥½ã¾ã—ããªã„(rejected)ã€ã®æ–‡æ›¸ãƒšã‚¢ã‚’nî˜€ğ‘¿(ğ‘–)chosen, ğ‘¿(ğ‘–)rejectedî˜oğ‘ğ‘–=1ã®å½¢ã§ç”¨æ„ã™ã‚‹ã€‚
ğ‘– ç•ªç›®ã®ãƒšã‚¢ã«å¯¾ã—ã¦è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ãŒå‡ºåŠ›ã™ã‚‹ã‚¹ã‚³ã‚¢ã‚’ ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)chosenî˜, ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)rejectedî˜ã¨ã—ã€ãã®å·®ã‚’scorediï¬€(ğ‘–)= ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)chosenî˜âˆ’ ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)rejectedî˜ã¨å®šç¾©ã™ã‚‹ã€‚
è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®ç›®æ¨™ã¯ã€chosen ã®ã»ã†ãŒrejected ã‚ˆã‚Šã‚‚é«˜ã„ã‚¹ã‚³ã‚¢ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨ã§ã‚ã‚Šã€ã“ã®æ¡ä»¶ã‚’æº€ãŸã™ã‚ˆã†ã«æ¬¡ã®æå¤±é–¢æ•°ã‚’æœ€å°åŒ–ã™ã‚‹ï¼šL(ğœ™) =ğ‘Ã•ğ‘–=1logî˜1+expî˜€âˆ’î˜‚ğ‘ ğœ™( ğ‘¿(ğ‘–)chosen)âˆ’ğ‘ ğœ™( ğ‘¿(ğ‘–)rejected)î˜ƒî˜î˜‘.(1)ã“ã®æå¤±ã‚’æœ€å°åŒ–ã™ã‚‹ã“ã¨ã§ã€è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã¯chosen ã‚’é«˜ãã€rejected ã‚’ä½ãã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã™ã‚‹ã‚ˆã†å­¦ç¿’ã•ã‚Œã‚‹ã€‚
Step2: èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®åé›†æ¬¡ã«ã€å­¦ç¿’ã—ãŸè„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã‚’ç”¨ã„ã¦èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®åé›†ã‚’è¡Œã†ã€‚
Step1 ã§ã¯ãƒ‡ã‚³ãƒ¼ãƒ€ã®æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦é¸å¥½ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã‚ã£ãŸãŒã€Step2 ã§ã¯è„³æ³¢ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‹ã‚‰èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åé›†ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã‚ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€ã‚ã‚‹äºŒã¤ã®æ–‡ç« ã«å¯¾ã—ã¦è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã‚’ç”¨ã„ã¦ã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã™ã‚‹ã€‚
ã‚¹ã‚³ã‚¢ãŒé«˜ã„æ–‡ç« ã‚’ chosenã€ã‚¹ã‚³ã‚¢ãŒä½ã„æ–‡ç« ã‚’ rejected ã¨ã¿ãªã—ã€ã“ã‚Œã‚‰ã®æ–‡ç« ãƒšã‚¢ã¨å¯¾å¿œã™ã‚‹é¸å¥½æƒ…å ±ã‚’åé›†ã™ã‚‹ã€‚
ã“ã®æ–¹æ³•ã«ã‚ˆã‚Šã€å¾“æ¥å¿…è¦ã¨ã•ã‚Œã¦ã„ãŸäººé–“ã«ã‚ˆã‚‹é¸å¥½ãƒ©ãƒ™ãƒ«ä»˜ã‘ã®æ‰‹é–“ã‚’å‰Šæ¸›ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚‹ã€‚
Step3: èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ã DPOStep3 ã§ã¯ã€Step2 ã§åé›†ã—ãŸé¸å¥½ãƒ‡ãƒ¼ã‚¿ï¼ˆèªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼‰ã‚’ç”¨ã„ã¦ã€DPO ã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ã®æœ€é©åŒ–ã‚’è¡Œã†ã€‚
DPO ã¯ã€å‚ç…§ãƒ¢ãƒ‡ãƒ«ã¨æ¯”è¼ƒã—ã¦ã€å¥½ã¾ã—ã„å‡ºåŠ›ãŒé¸æŠã•ã‚Œã‚‹ç¢ºç‡ã‚’æœ€å¤§åŒ–ã™ã‚‹ã‚ˆã†ã«ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹æ‰‹æ³•ã§ã‚ã‚Šã€å ±é…¬ãƒ¢ãƒ‡ãƒ«ãªã—ã§ã€é¸å¥½ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç›´æ¥æœ€é©åŒ–ã‚’è¡Œã†ã“ã¨ãŒã§ãã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€ãƒ¢ãƒ‡ãƒ« ğœ‹ğœƒã®æ¡ä»¶ä»˜ãç¢ºç‡åˆ†å¸ƒã¨å‚ç…§ãƒ¢ãƒ‡ãƒ« ğœ‹refã®æ¡ä»¶ä»˜ãç¢ºç‡åˆ†å¸ƒã‚’ç”¨ã„ã¦ã€æ¬¡ã®æå¤±é–¢æ•°ã‚’æœ€å°åŒ–ã™ã‚‹ï¼šLDPO( ğœƒ ) = âˆ’1ğ‘ğ‘Ã•ğ‘–=1log ğœÂ©îš­îš­Â«ğ›½Â©îš­îš­Â«logğœ‹ğœƒ(ğ’š(ğ‘–)chosen|ğ’™(ğ‘–))ğœ‹ref(ğ’š(ğ‘–)chosen|ğ’™(ğ‘–))
âˆ’ logğœ‹ğœƒ(ğ’š(ğ‘–)rejected|ğ’™(ğ‘–))ğœ‹ref(ğ’š(ğ‘–)rejected|ğ’™(ğ‘–))ÂªÂ®Â®Â¬ÂªÂ®Â®Â¬,(2)ã“ã‚Œã«ã‚ˆã‚Šã€Step2 ã§å¾—ã‚‰ã‚ŒãŸèªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’æ´»ç”¨ã—ã€ç”Ÿæˆãƒ¢ãƒ‡ãƒ«ã‚’è¢«é¨“è€…ã®é¸å¥½ã«é©åˆã•ã›ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚‹ã€‚



3.2 é¸å¥½ãƒšã‚¢ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ

ä½¿ç”¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæœ¬å®Ÿé¨“ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ã—ã¦ Zurich Cognitive Language Processing Corpus(ä»¥ä¸‹ ZuCo)[12]ã«åéŒ²ã•ã‚Œã¦ã„ã‚‹SentimentReading (SR)ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç”¨ã„ãŸã€‚
ã“ã®ã‚³ãƒ¼ãƒ‘ã‚¹ã¯ã‚¢ã‚¤ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã¨ EEG ã®è¨˜éŒ²ã‚’åŒæ™‚ã«è¡Œã£ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã‚ã‚Šã€12 äººã®è¢«é¨“è€…ã«ã‚ˆã£ã¦èª­ã¾ã‚ŒãŸç´„ 400 æ–‡ã‚’å«ã‚€ã€‚
æ–‡ç« ã¯å…¨

Cognitive Preference Optimization: è„³æƒ…å ±ã«ã‚ˆã‚‹è¨€èªãƒ¢ãƒ‡ãƒ«ã®é¸å¥½æœ€é©åŒ–

åŸç”°å®¥éƒ½â€ƒå¤§é–¢æ´‹å¹³



æ±äº¬å¤§å­¦



â€ƒ{harada-yuto, oseki}@g.ecc.u-tokyo.ac.jp



æ¦‚è¦

è¿‘å¹´ã®å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½å‘ä¸Šã«ãŠã„ã¦ã€Direct Preference Optimization (DPO)ã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã®æˆåŠŸãŒå¤§ããªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã‚‹ã€‚
ã—ã‹ã—ã€å­¦ç¿’ã§ç”¨ã„ã‚‰ã‚Œã‚‹ãƒ©ãƒ™ãƒ«ã®ä½œæˆã«ã¯å¤šå¤§ãªã‚³ã‚¹ãƒˆãŒå¿…è¦ã§ã‚ã‚Šã€ä½œæ¥­è€…ã®è² æ‹…ã‚‚å¤§ãã„ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€ä½œæ¥­è€…ãŒãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚“ã§ã„ã‚‹éš›ã®è„³æ³¢ã‹ã‚‰é¸å¥½æƒ…å ±ã‚’æŠ½å‡ºã—ã€ãã‚Œã«åŸºã¥ããƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹æ‰‹æ³•ã¨ã—ã¦ Cognitive Preference Optimization (CPO)ã‚’æ–°ãŸã«ææ¡ˆã™ã‚‹ã€‚
CPO ã§ã¯ã€ä½œæ¥­è€…ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚€ã ã‘ã§ãƒ©ãƒ™ãƒ«ã‚’ä½œæˆã§ãã€è² æ‹…ã®è»½æ¸›ãŒæœŸå¾…ã§ãã‚‹ã€‚
äººé–“ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ç”¨ã„ãŸå ´åˆã¨æ¯”è¼ƒã—ã¦ã€æ‰‹æ³•ã®å¦¥å½“æ€§ã‚’æ¤œè¨¼ã—ãŸã€‚


1 ã¯ã˜ã‚ã«

å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã®é–‹ç™ºã«ãŠã„ã¦ã€å®‰å…¨ã§ãƒ¦ãƒ¼ã‚¶ã«å¥½ã¾ã‚Œã‚‹å‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ¢ãƒ‡ãƒ«ãŒäººé–“ã®æ„å›³ã‚„ä¾¡å€¤è¦³ã«æ²¿ã£ã¦å‹•ä½œã™ã‚‹ã‚ˆã†ã«èª¿æ•´ã™ã‚‹ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆãŒä¸å¯æ¬ ã§ã‚ã‚‹ã€‚
äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã«å¯¾ã™ã‚‹äº‹å¾Œå­¦ç¿’ã¨ã—ã¦ã¯ã€Supervised Fine-tuning (SFT)ã‚’è¡Œã„ã€ã•ã‚‰ã«äººé–“ã®é¸å¥½ã‚’å–ã‚Šå…¥ã‚Œã‚‹ Direct Preference Optimization(DPO)[1]ã«ã‚ˆã‚‹æœ€é©åŒ–ã‚’è¡Œã†ã¨ã„ã†æµã‚ŒãŒä¸»æµã§ã‚ã‚Šã€æœ€å…ˆç«¯ã®ãƒ¢ãƒ‡ãƒ«ã§ã‚‚ã“ã‚Œã‚‰ã®æ‰‹æ³•ãŒå¤‰ã‚ã‚‰ãšæ¡ç”¨ã•ã‚Œã¦ã„ã‚‹[2]ã€‚
ã—ã‹ã—ã€DPO ãªã©ã®ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–æ‰‹æ³•ã§å¿…è¦ã¨ã•ã‚Œã‚‹é¸å¥½ãƒ©ãƒ™ãƒ«ã®ä½œæˆã«ã¯å¤§ããªè² æ‹…ãŒä¼´ã„ã€ä½œæ¥­è€…ã®é¸æŠœã‚„æ•™è‚²ã€ä½œæ¥­è€…ã¨ã®ä¿¡é ¼é–¢ä¿‚ã®æ§‹ç¯‰ãªã©ã€é•·æœŸçš„ãªã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ç‚¹ã¯å¤§ããªèª²é¡Œã§ã‚ã‚‹[3]ã€‚
ã“ã®ã‚ˆã†ãªçŠ¶æ³ã‚’è¸ã¾ãˆã€è¿‘å¹´ã§ã¯ AI Feedback[4]ã®ã‚ˆã†ã«ã€å¾“æ¥ã®äººæ‰‹ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è£œå®Œãƒ»ä»£æ›¿ã™ã‚‹æ‰‹æ³•ã‚‚é–‹ç™ºã•ã‚Œã¦ããŸã€‚
æœ¬ç ”ç©¶ã§ã¯ã€ã“ã‚Œã‚‰ã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã®æ ¹å¹¹ã¨ãªã‚‹ã€Œäººé–“ã®é¸å¥½æƒ…å ±ã€ã®å–å¾—æ–¹æ³•ã«ã¤ã„ã¦ã€è„³æ´»å‹•ãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã§ããªã„ã‹ã¨ã„ã†æ–°ãŸãªè¦³ç‚¹ã‹ã‚‰å›³ 1: ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®æ¦‚è¦å›³æ¤œè¨ã‚’è¡Œã†ã€‚
ç‰¹ã«ã€DPO ãªã©ã®ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–æ‰‹æ³•ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã«ãŠã„ã¦ã‚‚ã€è„³æ³¢ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹é¸å¥½æƒ…å ±ã¯ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ã«æ´»ç”¨ã§ãã‚‹ã®ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€DPO ãŒæœ€åˆã«ææ¡ˆã•ã‚ŒãŸéš›ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¿ã‚¹ã‚¯ã®ä¸€ã¤ã§ã‚ã‚‹æ„Ÿæƒ…ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ç”Ÿæˆï¼ˆControlled Sentiment Generationï¼‰ã‚’å¯¾è±¡ã¨ã—ã€è¢«é¨“è€…ãŒãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚“ã§ã„ã‚‹éš›ã«è¨ˆæ¸¬ã•ã‚Œã‚‹è„³æ³¢ã‚’ç”¨ã„ã¦ãƒ¢ãƒ‡ãƒ«ã®é¸å¥½æœ€é©åŒ–ã‚’è¡Œã†æ‰‹æ³•ã¨ã—ã¦ Cognitive Preference Optimization(CPO)ã‚’ææ¡ˆã™ã‚‹ã€‚
CPO ã§ã¯ã€äººé–“ãŒãƒ†ã‚­ã‚¹ãƒˆã«å¯¾ã—ã¦ç›´æ¥ãƒ©ãƒ™ãƒ«ä»˜ã‘ã‚’è¡Œã†ã®ã§ã¯ãªãã€è„³æ³¢è¨ˆæ¸¬ã«ã‚ˆã£ã¦æ¨å®šã•ã‚ŒãŸé¸å¥½æƒ…å ±ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã€å¾“æ¥ã®äººæ‰‹ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã‚‹ï¼ˆå›³ 1ï¼‰ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€å¾“æ¥ã®äººé–“ãŒæ˜ç¤ºçš„ã«ä½œæˆã™ã‚‹ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ã€è„³æ´»å‹•ã‹ã‚‰ä½œæˆã•ã‚Œã‚‹æš—é»™çš„ãªèªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã€äºŒã¤ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ãå­¦ç¿’æ‰‹æ³•ã¨ã®æ¯”è¼ƒã‚’è¡Œã†ã“ã¨ã§ã€ãã®å¦¥å½“æ€§ã‚’æ¤œè¨¼ã—ãŸã€‚
å®Ÿé¨“ã®çµæœã€ææ¡ˆæ‰‹æ³•ã‚’ç”¨ã„ãŸãƒ¢ãƒ‡ãƒ«ã¯ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨æ¯”è¼ƒã—ã¦ã‚ˆã‚Šãƒã‚¸ãƒ†ã‚£ãƒ–ãªå‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–ãŒå¯èƒ½ã§ã‚ã‚‹ã“ã¨ãŒç¤ºã•ã‚ŒãŸã€‚
ã“ã‚Œã‚‰ã®çµæœã¯ã€LLMã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã«ãŠã‘ã‚‹æ–°ãŸãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ç¤ºå”†ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚


2 é–¢é€£ç ”ç©¶

è‡ªç„¶è¨€èªå‡¦ç†ã«ãŠã„ã¦ã€äººé–“ã®ç”Ÿç†çš„ãªæƒ…å ±ã‚’æ´»ç”¨ã—ã¦ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’å‘ä¸Šã•ã›ã‚ˆã†ã¨ã™ã‚‹ç ”ç©¶ã¯ Cognitively Inspired NLP ã¨å‘¼ã°ã‚Œã‚‹åˆ†é‡ã¨ã—ã¦æ•°å¤šãå ±å‘Šã•ã‚Œã¦ã„ã‚‹ã€‚
ã“ã‚Œã‚‰ã®ç ”ç©¶ã§ã¯ã€è„³æ³¢ã‚„è¦–ç·šãªã©ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹äººé–“ã®ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã•ã¾ã–ã¾ãªä¸‹æµã‚¿ã‚¹ã‚¯ã«ãŠã„ã¦æ€§èƒ½æ”¹å–„ãŒå¾—ã‚‰ã‚Œã‚‹ã“ã¨ãŒç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€å“è©è§£æ[5]ã€ä¾å­˜æ§‹é€ è§£æ[6]ã€æ„Ÿæƒ…åˆ†æ[7]ã€å›ºæœ‰è¡¨ç¾èªè­˜[8, 9]ã€é–¢ä¿‚æŠ½å‡º[10]ãªã©éå¸¸ã«å¹…åºƒã„ã‚¿ã‚¹ã‚¯ã«é©ç”¨ã•ã‚Œã¦ãŠã‚Šã€ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹è£œåŠ©æƒ…å ±ã¯ã‚¿ã‚¹ã‚¯ã«ä¾å­˜ã›ãšæœ‰ç›ŠãªåŠ¹æœã‚’ã‚‚ãŸã‚‰ã™ã“ã¨ãŒç¤ºå”†ã•ã‚Œã¦ã„ã‚‹ã€‚
ä¸€æ–¹ã§ã€ã“ã‚Œã‚‰ã®ç ”ç©¶ã®å¤šãã¯ LSTM ãƒ™ãƒ¼ã‚¹ã®ãƒ¢ãƒ‡ãƒ«ã‚’å¯¾è±¡ã¨ã—ã¦ã„ã‚‹ã€‚
è¿‘å¹´ä¸»æµã¨ãªã£ã¦ã„ã‚‹ Transformer ãƒ™ãƒ¼ã‚¹ã®å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã¸ã®é©ç”¨ä¾‹ã¯é™å®šçš„ã§ã‚ã‚‹ã†ãˆã€é©ç”¨ã®ãŸã‚ã«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å¤‰æ›´ãŒå¿…è¦[11]ã§ã‚ã‚Šã€æ—¢å­˜ã®äº‹å‰å­¦ç¿’æ¸ˆãƒ¢ãƒ‡ãƒ«ã‚’æ´»ç”¨ã§ããªã„ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç›´æ¥å¤‰æ›´ã™ã‚‹ã“ã¨ãªãã€äººé–“ã®ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰é¸å¥½æƒ…å ±ã‚’ä½œæˆã™ã‚‹æ‰‹æ³•ã‚’ææ¡ˆã™ã‚‹ã€‚
äº‹å¾Œå­¦ç¿’ã®æ®µéšã§ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€æ—¢å­˜ã®å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã«ã‚‚é©ç”¨å¯èƒ½ãªæ‰‹æ³•ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã‚‹ã€‚


3 æ‰‹æ³•



3.1 Cognitive Preference Optimization

æ‰‹æ³•å…¨ä½“ã®æµã‚Œã‚’å›³ 2 ã«ç¤ºã™ã€‚
Step1: è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®å­¦ç¿’ã¾ãšã€ã‚ã‚‹æ–‡æ›¸ã‚’èª­ã‚“ã§ã„ã‚‹éš›ã® EEG ç‰¹å¾´ç³»åˆ—ã‚’ ğ‘¿ =(ğ’™1, ğ’™2, . . . , ğ’™ğ‘‡)ã¨è¡¨ã—ã€å„ ğ’™ğ‘¡âˆˆ â„ğ‘šã¯æ–‡æ›¸ä¸­ã®å˜èª ğ‘¡ ã«å¯¾å¿œã™ã‚‹ EEG ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã¨ã™ã‚‹ã€‚
æ–‡æ›¸ã®å˜èªæ•°ã‚’ ğ‘‡ ã¨ã™ã‚‹ã€‚
è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã¯ã“ã® EEG ç³»åˆ—ã‚’å…¥åŠ›ã¨ã—ã€ã‚¹ã‚«ãƒ©ãƒ¼å€¤ã‚’å‡ºåŠ›ã™ã‚‹é–¢æ•° ğ‘ ğœ™( ğ‘¿) âˆˆ â„ ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚
ã“ã“ã§ã€ğœ™ ã¯ãƒ‡ã‚³ãƒ¼ãƒ€ã®å­¦ç¿’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚ã‚‹ã€‚
å­¦ç¿’ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦ã€ã€Œå¥½ã¾ã—ã„(chosen)ã€ã¨ã€Œå¥½ã¾ã—ããªã„(rejected)ã€ã®æ–‡æ›¸ãƒšã‚¢ã‚’nî˜€ğ‘¿(ğ‘–)chosen, ğ‘¿(ğ‘–)rejectedî˜oğ‘ğ‘–=1ã®å½¢ã§ç”¨æ„ã™ã‚‹ã€‚
ğ‘– ç•ªç›®ã®ãƒšã‚¢ã«å¯¾ã—ã¦è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ãŒå‡ºåŠ›ã™ã‚‹ã‚¹ã‚³ã‚¢ã‚’ ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)chosenî˜, ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)rejectedî˜ã¨ã—ã€ãã®å·®ã‚’scorediï¬€(ğ‘–)= ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)chosenî˜âˆ’ ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)rejectedî˜ã¨å®šç¾©ã™ã‚‹ã€‚
è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®ç›®æ¨™ã¯ã€chosen ã®ã»ã†ãŒrejected ã‚ˆã‚Šã‚‚é«˜ã„ã‚¹ã‚³ã‚¢ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨ã§ã‚ã‚Šã€ã“ã®æ¡ä»¶ã‚’æº€ãŸã™ã‚ˆã†ã«æ¬¡ã®æå¤±é–¢æ•°ã‚’æœ€å°åŒ–ã™ã‚‹ï¼šL(ğœ™) =ğ‘Ã•ğ‘–=1logî˜1+expî˜€âˆ’î˜‚ğ‘ ğœ™( ğ‘¿(ğ‘–)chosen)âˆ’ğ‘ ğœ™( ğ‘¿(ğ‘–)rejected)î˜ƒî˜î˜‘.(1)ã“ã®æå¤±ã‚’æœ€å°åŒ–ã™ã‚‹ã“ã¨ã§ã€è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã¯chosen ã‚’é«˜ãã€rejected ã‚’ä½ãã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã™ã‚‹ã‚ˆã†å­¦ç¿’ã•ã‚Œã‚‹ã€‚
Step2: èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®åé›†æ¬¡ã«ã€å­¦ç¿’ã—ãŸè„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã‚’ç”¨ã„ã¦èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®åé›†ã‚’è¡Œã†ã€‚
Step1 ã§ã¯ãƒ‡ã‚³ãƒ¼ãƒ€ã®æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦é¸å¥½ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã‚ã£ãŸãŒã€Step2 ã§ã¯è„³æ³¢ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‹ã‚‰èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åé›†ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã‚ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€ã‚ã‚‹äºŒã¤ã®æ–‡ç« ã«å¯¾ã—ã¦è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã‚’ç”¨ã„ã¦ã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã™ã‚‹ã€‚
ã‚¹ã‚³ã‚¢ãŒé«˜ã„æ–‡ç« ã‚’ chosenã€ã‚¹ã‚³ã‚¢ãŒä½ã„æ–‡ç« ã‚’ rejected ã¨ã¿ãªã—ã€ã“ã‚Œã‚‰ã®æ–‡ç« ãƒšã‚¢ã¨å¯¾å¿œã™ã‚‹é¸å¥½æƒ…å ±ã‚’åé›†ã™ã‚‹ã€‚
ã“ã®æ–¹æ³•ã«ã‚ˆã‚Šã€å¾“æ¥å¿…è¦ã¨ã•ã‚Œã¦ã„ãŸäººé–“ã«ã‚ˆã‚‹é¸å¥½ãƒ©ãƒ™ãƒ«ä»˜ã‘ã®æ‰‹é–“ã‚’å‰Šæ¸›ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚‹ã€‚
Step3: èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ã DPOStep3 ã§ã¯ã€Step2 ã§åé›†ã—ãŸé¸å¥½ãƒ‡ãƒ¼ã‚¿ï¼ˆèªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼‰ã‚’ç”¨ã„ã¦ã€DPO ã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ã®æœ€é©åŒ–ã‚’è¡Œã†ã€‚
DPO ã¯ã€å‚ç…§ãƒ¢ãƒ‡ãƒ«ã¨æ¯”è¼ƒã—ã¦ã€å¥½ã¾ã—ã„å‡ºåŠ›ãŒé¸æŠã•ã‚Œã‚‹ç¢ºç‡ã‚’æœ€å¤§åŒ–ã™ã‚‹ã‚ˆã†ã«ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹æ‰‹æ³•ã§ã‚ã‚Šã€å ±é…¬ãƒ¢ãƒ‡ãƒ«ãªã—ã§ã€é¸å¥½ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç›´æ¥æœ€é©åŒ–ã‚’è¡Œã†ã“ã¨ãŒã§ãã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€ãƒ¢ãƒ‡ãƒ« ğœ‹ğœƒã®æ¡ä»¶ä»˜ãç¢ºç‡åˆ†å¸ƒã¨å‚ç…§ãƒ¢ãƒ‡ãƒ« ğœ‹refã®æ¡ä»¶ä»˜ãç¢ºç‡åˆ†å¸ƒã‚’ç”¨ã„ã¦ã€æ¬¡ã®æå¤±é–¢æ•°ã‚’æœ€å°åŒ–ã™ã‚‹ï¼šLDPO( ğœƒ ) = âˆ’1ğ‘ğ‘Ã•ğ‘–=1log ğœÂ©îš­îš­Â«ğ›½Â©îš­îš­Â«logğœ‹ğœƒ(ğ’š(ğ‘–)chosen|ğ’™(ğ‘–))ğœ‹ref(ğ’š(ğ‘–)chosen|ğ’™(ğ‘–))
âˆ’ logğœ‹ğœƒ(ğ’š(ğ‘–)rejected|ğ’™(ğ‘–))ğœ‹ref(ğ’š(ğ‘–)rejected|ğ’™(ğ‘–))ÂªÂ®Â®Â¬ÂªÂ®Â®Â¬,(2)ã“ã‚Œã«ã‚ˆã‚Šã€Step2 ã§å¾—ã‚‰ã‚ŒãŸèªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’æ´»ç”¨ã—ã€ç”Ÿæˆãƒ¢ãƒ‡ãƒ«ã‚’è¢«é¨“è€…ã®é¸å¥½ã«é©åˆã•ã›ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚‹ã€‚



3.2 é¸å¥½ãƒšã‚¢ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ

ä½¿ç”¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæœ¬å®Ÿé¨“ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ã—ã¦ Zurich Cognitive Language Processing Corpus(ä»¥ä¸‹ ZuCo)[12]ã«åéŒ²ã•ã‚Œã¦ã„ã‚‹SentimentReading (SR)ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç”¨ã„ãŸã€‚
ã“ã®ã‚³ãƒ¼ãƒ‘ã‚¹ã¯ã‚¢ã‚¤ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã¨ EEG ã®è¨˜éŒ²ã‚’åŒæ™‚ã«è¡Œã£ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã‚ã‚Šã€12 äººã®è¢«é¨“è€…ã«ã‚ˆã£ã¦èª­ã¾ã‚ŒãŸç´„ 400 æ–‡ã‚’å«ã‚€ã€‚
æ–‡ç« ã¯å…¨ã¦æ˜ ç”»ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼æ–‡ã§ã‚ã‚Šã€Stanford SentimentTreebank (SST)ã‹ã‚‰æŠ½å‡ºã•ã‚ŒãŸã‚‚ã®ã§ã‚ã‚‹ã€‚
è„³æ³¢ã¯è¦–ç·šãƒ‡ãƒ¼ã‚¿ï¼ˆGaze Durationï¼‰ã«åŸºã¥ã„ã¦æŠ½å‡ºã—ã¦ãŠã‚Šã€840 æ¬¡å…ƒã®ãƒ™ã‚¯ãƒˆãƒ«ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ã€‚
ãƒšã‚¢ãƒ‡ãƒ¼ã‚¿ã¸ã®å¤‰æ›æœ¬ç ”ç©¶ã§ã¯ã€ZuCo SRãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç”¨ã„ã¦ãƒšã‚¢ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ã€‚
ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯ã€SSTï¼ˆStanford SentimentTreebankï¼‰[13]ãŒä½œæˆã•ã‚ŒãŸéš›ã«ä»˜ä¸ã•ã‚ŒãŸGround Truth ãƒ©ãƒ™ãƒ«ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€400 æ–‡ã®ã†ã¡ 140 æ–‡ãŒ positiveã€137 æ–‡ãŒ neutralã€123 æ–‡ãŒnegative ã«åˆ†é¡ã•ã‚Œã‚‹ã€‚
ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ã‚’é˜²ããŸã‚ã€ã“ã‚Œã‚‰ã®ãƒ©ãƒ™ãƒ«åˆ†å¸ƒã‚’ç¶­æŒã—ãŸã¾ã¾ã€10-foldã«åˆ†å‰²ã—ã¦ãƒšã‚¢ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ã€‚
ãƒšã‚¢ä½œæˆã®éš›ã«ã¯ã€positive > neutral ã®é–¢ä¿‚ã€ã•ã‚‰ã« positive> negative ã®é–¢ä¿‚ã«åŸºã¥ã„ã¦ãƒšã‚¢ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚
ç†è«–ä¸Šã€positive ãªæ–‡ã¨ neutral ãªæ–‡ã®çµ„ã¿åˆã‚ã›æ•°ã€ã‚ã‚‹ã„ã¯ positive ãªæ–‡ã¨ negative ãªæ–‡ã®çµ„ã¿åˆã‚ã›æ•°ã«åŸºã¥ãæœ€å¤§ã®ãƒšã‚¢ã‚’ä½œæˆå¯èƒ½ã§ã‚ã‚‹ãŒã€è¨“ç·´æ™‚ã«ã¯å„æ–‡ã«ã¤ãæœ€å¤§ 5 ãƒšã‚¢ã®ã¿ã‚’ä½œæˆã™ã‚‹ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿å…¨ä½“ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ä½ä¸‹ã«ã‚ˆã‚‹éå­¦ç¿’ã‚’é˜²ãã€‚
ä¸€æ–¹ã€ãƒ†ã‚¹ãƒˆæ™‚ã«ã¯å¯èƒ½ãªé™ã‚Šã™ã¹ã¦ã®ãƒšã‚¢ã‚’ç”Ÿæˆã™ã‚‹ã€‚
è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®å­¦ç¿’ã¯ 10 åˆ†å‰²äº¤å·®æ¤œè¨¼ã«ã‚ˆã‚Šè¡Œã„ã€å„fold ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«ãŠã‘ã‚‹çµæœã§ã‚ã‚‹å…¨ 3640ä»¶ã‚’èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ã€‚
ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®å–å¾— ZuCo SRãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å«ã¾ã‚Œã‚‹ 400 æ–‡ã®ã†ã¡ã€47 æ–‡ã«ã¯è¢«é¨“è€…ãŒå›ç­”ã—ãŸæ„Ÿæƒ…ãƒ©ãƒ™ãƒ«ï¼ˆ5 æ®µéšè©•ä¾¡ï¼‰ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ã€‚
ã“ã‚Œã‚‰ã® 47 æ–‡ã®å†…è¨³ã¯ã€Ground Truth ãƒ©ãƒ™ãƒ«ã§ positive ãŒ 22 æ–‡ã€neutral ãŒ6 æ–‡ã€negative ãŒ 17 æ–‡ã§ã‚ã‚‹ã€‚
Ground Truth ã®ãƒ©ãƒ™ãƒ«ã«åŸºã¥ãã€ã“ã‚Œã‚‰ã® 47 æ–‡ã‹ã‚‰è¨ˆ 506 ãƒšã‚¢ã‚’ä½œæˆã™ã‚‹ã€‚
ä½œæˆã•ã‚ŒãŸãƒšã‚¢ã«å¯¾ã—ã¦ã€è¢«é¨“è€…ãŒä»˜ä¸ã—ãŸ 5 æ®µéšã®æ„Ÿæƒ…ãƒ©ãƒ™ãƒ«ã‚’åŸºã«é¸å¥½æƒ…å ±ã‚’æ§‹ç¯‰ã—ã€ã“ã‚Œã‚’ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ã—ã¦åˆ©ç”¨ã™ã‚‹ã€‚
ãªãŠã€ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¯èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«æ¯”ã¹ã¦ãƒ‡ãƒ¼ã‚¿æ•°ãŒå°‘ãªã„ãŸã‚ã€ä¸¡è€…ã‚’æ¯”è¼ƒã™ã‚‹éš›ã«ã¯ã€èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã®ä¸­ã‹ã‚‰åŒã˜ 506 ä»¶ã®ãƒ†ã‚­ã‚¹ãƒˆãƒšã‚¢ã‚’æŠ½å‡ºã—ã¦ä½¿ç”¨ã™ã‚‹ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ãŒç•°ãªã‚‹ã“ã¨ã«ã‚ˆã‚‹å½±éŸ¿ã‚’æ’é™¤ã—ã€ãƒ•ã‚§ã‚¢ãªæ¯”è¼ƒã‚’è¡Œã†ã€‚

3.3 å­¦ç¿’è¨­å®š

ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã¨ã—ã¦ã€[5]ã‚’å‚è€ƒã«ã€å°è¦æ¨¡ãª Transformer ã‚’ç”¨ã„ãŸã€‚
ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€äº‹å‰ã«ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒã‚’ç”¨ã„ã¦æ±ºå›³ 2: ææ¡ˆæ‰‹æ³•ã®å…¨ä½“ã®æµã‚Œã®æ¦‚è¦å›³ã€‚
è„³æ³¢ãƒ‡ãƒ¼ã‚¿ã®ãƒ‡ã‚³ãƒ¼ãƒ€ã‚’å­¦ç¿’ã™ã‚‹éš›ã«ã¯æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦é¸å¥½ãƒ©ãƒ™ãƒ«ãŒå¿…è¦ã«ãªã‚‹ãŒã€èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¯è„³æ³¢ã®ã¿ã‹ã‚‰åé›†ã™ã‚‹ã“ã¨ãŒã§ãã€ä½œæ¥­è€…ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚€ã ã‘ã§ã‚ˆã„ã€‚
å®šã—ãŸã€‚
num layers ã¯ 2ã€nhead ã‚’ 8ã€dmodel ã‚’512ã€dim feedforward ã‚’ 2048 ã«è¨­å®šã—ã¦å®Ÿé¨“ã‚’è¡Œã£ãŸã€‚
ã¾ãŸã€ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ã€IMDbãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ[14]ã§ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æ¸ˆã¿ã® GPT-2 medium1ï¼‰ã‚’ç”¨ã„ãŸã€‚
ä»¥é™ã“ã‚Œã‚’ SFT ãƒ¢ãƒ‡ãƒ«ã¨å‘¼ã¶ã€‚
IMDb ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ SST ã¨åŒæ§˜ã«æ˜ ç”»ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§æ§‹æˆã•ã‚Œã¦ã„ã‚‹ãŒã€ä¸¡è€…ã¯ç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«ä½œæˆã•ã‚ŒãŠã‚Šãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ã®æ‡¸å¿µã¯ãªã„ã€‚
ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡ä½œæˆã—ãŸãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡ã§ã¯ã€SST ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ä¸­ã‹ã‚‰ã€ZuCo SR ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«åéŒ²ã•ã‚Œã¦ã„ãªã„ä¾‹ã‚’ã€neutral æ–‡ã‚’ 50ã€negative æ–‡ã‚’ 50 æŠ½å‡ºã—ã€ãã‚Œã‚‰ã®åˆæœŸ 10 å˜èªã®ã¿ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®å…¥åŠ›ã¨ã—ã¦ä¸ãˆã€ç¶šãã‚’ç”Ÿæˆã•ã›ãŸã€‚
ç”Ÿæˆã•ã›ãŸæ–‡ç« ã«ã¤ã„ã¦ã€gpt-4o-2024-11-20 ã«ã‚ˆã‚‹ llm-as-a-judge ã‚’å®Ÿæ–½ã—ãŸã€‚
ã‚ˆã‚Šãƒã‚¸ãƒ†ã‚£ãƒ–ãªæ–‡ç« ã‚’å‡ºåŠ›ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’é¸ã°ã›ã€ãã‚Œã«åŸºã¥ã 2 ãƒ¢ãƒ‡ãƒ«é–“ã® Win1ï¼‰ https://huggingface.co/edbeeching/gpt2-medium-imdb

Cognitive Preference Optimization: è„³æƒ…å ±ã«ã‚ˆã‚‹è¨€èªãƒ¢ãƒ‡ãƒ«ã®é¸å¥½æœ€é©åŒ–

åŸç”°å®¥éƒ½â€ƒå¤§é–¢æ´‹å¹³



æ±äº¬å¤§å­¦



â€ƒ{harada-yuto, oseki}@g.ecc.u-tokyo.ac.jp



æ¦‚è¦

è¿‘å¹´ã®å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½å‘ä¸Šã«ãŠã„ã¦ã€Direct Preference Optimization (DPO)ã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã®æˆåŠŸãŒå¤§ããªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã‚‹ã€‚
ã—ã‹ã—ã€å­¦ç¿’ã§ç”¨ã„ã‚‰ã‚Œã‚‹ãƒ©ãƒ™ãƒ«ã®ä½œæˆã«ã¯å¤šå¤§ãªã‚³ã‚¹ãƒˆãŒå¿…è¦ã§ã‚ã‚Šã€ä½œæ¥­è€…ã®è² æ‹…ã‚‚å¤§ãã„ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€ä½œæ¥­è€…ãŒãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚“ã§ã„ã‚‹éš›ã®è„³æ³¢ã‹ã‚‰é¸å¥½æƒ…å ±ã‚’æŠ½å‡ºã—ã€ãã‚Œã«åŸºã¥ããƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹æ‰‹æ³•ã¨ã—ã¦ Cognitive Preference Optimization (CPO)ã‚’æ–°ãŸã«ææ¡ˆã™ã‚‹ã€‚
CPO ã§ã¯ã€ä½œæ¥­è€…ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚€ã ã‘ã§ãƒ©ãƒ™ãƒ«ã‚’ä½œæˆã§ãã€è² æ‹…ã®è»½æ¸›ãŒæœŸå¾…ã§ãã‚‹ã€‚
äººé–“ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ç”¨ã„ãŸå ´åˆã¨æ¯”è¼ƒã—ã¦ã€æ‰‹æ³•ã®å¦¥å½“æ€§ã‚’æ¤œè¨¼ã—ãŸã€‚


1 ã¯ã˜ã‚ã«

å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã®é–‹ç™ºã«ãŠã„ã¦ã€å®‰å…¨ã§ãƒ¦ãƒ¼ã‚¶ã«å¥½ã¾ã‚Œã‚‹å‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ¢ãƒ‡ãƒ«ãŒäººé–“ã®æ„å›³ã‚„ä¾¡å€¤è¦³ã«æ²¿ã£ã¦å‹•ä½œã™ã‚‹ã‚ˆã†ã«èª¿æ•´ã™ã‚‹ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆãŒä¸å¯æ¬ ã§ã‚ã‚‹ã€‚
äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã«å¯¾ã™ã‚‹äº‹å¾Œå­¦ç¿’ã¨ã—ã¦ã¯ã€Supervised Fine-tuning (SFT)ã‚’è¡Œã„ã€ã•ã‚‰ã«äººé–“ã®é¸å¥½ã‚’å–ã‚Šå…¥ã‚Œã‚‹ Direct Preference Optimization(DPO)[1]ã«ã‚ˆã‚‹æœ€é©åŒ–ã‚’è¡Œã†ã¨ã„ã†æµã‚ŒãŒä¸»æµã§ã‚ã‚Šã€æœ€å…ˆç«¯ã®ãƒ¢ãƒ‡ãƒ«ã§ã‚‚ã“ã‚Œã‚‰ã®æ‰‹æ³•ãŒå¤‰ã‚ã‚‰ãšæ¡ç”¨ã•ã‚Œã¦ã„ã‚‹[2]ã€‚
ã—ã‹ã—ã€DPO ãªã©ã®ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–æ‰‹æ³•ã§å¿…è¦ã¨ã•ã‚Œã‚‹é¸å¥½ãƒ©ãƒ™ãƒ«ã®ä½œæˆã«ã¯å¤§ããªè² æ‹…ãŒä¼´ã„ã€ä½œæ¥­è€…ã®é¸æŠœã‚„æ•™è‚²ã€ä½œæ¥­è€…ã¨ã®ä¿¡é ¼é–¢ä¿‚ã®æ§‹ç¯‰ãªã©ã€é•·æœŸçš„ãªã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ç‚¹ã¯å¤§ããªèª²é¡Œã§ã‚ã‚‹[3]ã€‚
ã“ã®ã‚ˆã†ãªçŠ¶æ³ã‚’è¸ã¾ãˆã€è¿‘å¹´ã§ã¯ AI Feedback[4]ã®ã‚ˆã†ã«ã€å¾“æ¥ã®äººæ‰‹ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è£œå®Œãƒ»ä»£æ›¿ã™ã‚‹æ‰‹æ³•ã‚‚é–‹ç™ºã•ã‚Œã¦ããŸã€‚
æœ¬ç ”ç©¶ã§ã¯ã€ã“ã‚Œã‚‰ã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã®æ ¹å¹¹ã¨ãªã‚‹ã€Œäººé–“ã®é¸å¥½æƒ…å ±ã€ã®å–å¾—æ–¹æ³•ã«ã¤ã„ã¦ã€è„³æ´»å‹•ãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã§ããªã„ã‹ã¨ã„ã†æ–°ãŸãªè¦³ç‚¹ã‹ã‚‰å›³ 1: ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®æ¦‚è¦å›³æ¤œè¨ã‚’è¡Œã†ã€‚
ç‰¹ã«ã€DPO ãªã©ã®ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–æ‰‹æ³•ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã«ãŠã„ã¦ã‚‚ã€è„³æ³¢ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹é¸å¥½æƒ…å ±ã¯ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ã«æ´»ç”¨ã§ãã‚‹ã®ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€DPO ãŒæœ€åˆã«ææ¡ˆã•ã‚ŒãŸéš›ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¿ã‚¹ã‚¯ã®ä¸€ã¤ã§ã‚ã‚‹æ„Ÿæƒ…ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ç”Ÿæˆï¼ˆControlled Sentiment Generationï¼‰ã‚’å¯¾è±¡ã¨ã—ã€è¢«é¨“è€…ãŒãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚“ã§ã„ã‚‹éš›ã«è¨ˆæ¸¬ã•ã‚Œã‚‹è„³æ³¢ã‚’ç”¨ã„ã¦ãƒ¢ãƒ‡ãƒ«ã®é¸å¥½æœ€é©åŒ–ã‚’è¡Œã†æ‰‹æ³•ã¨ã—ã¦ Cognitive Preference Optimization(CPO)ã‚’ææ¡ˆã™ã‚‹ã€‚
CPO ã§ã¯ã€äººé–“ãŒãƒ†ã‚­ã‚¹ãƒˆã«å¯¾ã—ã¦ç›´æ¥ãƒ©ãƒ™ãƒ«ä»˜ã‘ã‚’è¡Œã†ã®ã§ã¯ãªãã€è„³æ³¢è¨ˆæ¸¬ã«ã‚ˆã£ã¦æ¨å®šã•ã‚ŒãŸé¸å¥½æƒ…å ±ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã€å¾“æ¥ã®äººæ‰‹ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã‚‹ï¼ˆå›³ 1ï¼‰ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€å¾“æ¥ã®äººé–“ãŒæ˜ç¤ºçš„ã«ä½œæˆã™ã‚‹ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ã€è„³æ´»å‹•ã‹ã‚‰ä½œæˆã•ã‚Œã‚‹æš—é»™çš„ãªèªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã€äºŒã¤ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ãå­¦ç¿’æ‰‹æ³•ã¨ã®æ¯”è¼ƒã‚’è¡Œã†ã“ã¨ã§ã€ãã®å¦¥å½“æ€§ã‚’æ¤œè¨¼ã—ãŸã€‚
å®Ÿé¨“ã®çµæœã€ææ¡ˆæ‰‹æ³•ã‚’ç”¨ã„ãŸãƒ¢ãƒ‡ãƒ«ã¯ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨æ¯”è¼ƒã—ã¦ã‚ˆã‚Šãƒã‚¸ãƒ†ã‚£ãƒ–ãªå‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–ãŒå¯èƒ½ã§ã‚ã‚‹ã“ã¨ãŒç¤ºã•ã‚ŒãŸã€‚
ã“ã‚Œã‚‰ã®çµæœã¯ã€LLMã®ã‚¢ãƒ©ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã«ãŠã‘ã‚‹æ–°ãŸãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ç¤ºå”†ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚


2 é–¢é€£ç ”ç©¶

è‡ªç„¶è¨€èªå‡¦ç†ã«ãŠã„ã¦ã€äººé–“ã®ç”Ÿç†çš„ãªæƒ…å ±ã‚’æ´»ç”¨ã—ã¦ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’å‘ä¸Šã•ã›ã‚ˆã†ã¨ã™ã‚‹ç ”ç©¶ã¯ Cognitively Inspired NLP ã¨å‘¼ã°ã‚Œã‚‹åˆ†é‡ã¨ã—ã¦æ•°å¤šãå ±å‘Šã•ã‚Œã¦ã„ã‚‹ã€‚
ã“ã‚Œã‚‰ã®ç ”ç©¶ã§ã¯ã€è„³æ³¢ã‚„è¦–ç·šãªã©ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹äººé–“ã®ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã•ã¾ã–ã¾ãªä¸‹æµã‚¿ã‚¹ã‚¯ã«ãŠã„ã¦æ€§èƒ½æ”¹å–„ãŒå¾—ã‚‰ã‚Œã‚‹ã“ã¨ãŒç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€å“è©è§£æ[5]ã€ä¾å­˜æ§‹é€ è§£æ[6]ã€æ„Ÿæƒ…åˆ†æ[7]ã€å›ºæœ‰è¡¨ç¾èªè­˜[8, 9]ã€é–¢ä¿‚æŠ½å‡º[10]ãªã©éå¸¸ã«å¹…åºƒã„ã‚¿ã‚¹ã‚¯ã«é©ç”¨ã•ã‚Œã¦ãŠã‚Šã€ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹è£œåŠ©æƒ…å ±ã¯ã‚¿ã‚¹ã‚¯ã«ä¾å­˜ã›ãšæœ‰ç›ŠãªåŠ¹æœã‚’ã‚‚ãŸã‚‰ã™ã“ã¨ãŒç¤ºå”†ã•ã‚Œã¦ã„ã‚‹ã€‚
ä¸€æ–¹ã§ã€ã“ã‚Œã‚‰ã®ç ”ç©¶ã®å¤šãã¯ LSTM ãƒ™ãƒ¼ã‚¹ã®ãƒ¢ãƒ‡ãƒ«ã‚’å¯¾è±¡ã¨ã—ã¦ã„ã‚‹ã€‚
è¿‘å¹´ä¸»æµã¨ãªã£ã¦ã„ã‚‹ Transformer ãƒ™ãƒ¼ã‚¹ã®å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã¸ã®é©ç”¨ä¾‹ã¯é™å®šçš„ã§ã‚ã‚‹ã†ãˆã€é©ç”¨ã®ãŸã‚ã«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å¤‰æ›´ãŒå¿…è¦[11]ã§ã‚ã‚Šã€æ—¢å­˜ã®äº‹å‰å­¦ç¿’æ¸ˆãƒ¢ãƒ‡ãƒ«ã‚’æ´»ç”¨ã§ããªã„ã€‚
æœ¬ç ”ç©¶ã§ã¯ã€äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç›´æ¥å¤‰æ›´ã™ã‚‹ã“ã¨ãªãã€äººé–“ã®ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰é¸å¥½æƒ…å ±ã‚’ä½œæˆã™ã‚‹æ‰‹æ³•ã‚’ææ¡ˆã™ã‚‹ã€‚
äº‹å¾Œå­¦ç¿’ã®æ®µéšã§ç”Ÿç†ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€æ—¢å­˜ã®å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã«ã‚‚é©ç”¨å¯èƒ½ãªæ‰‹æ³•ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã‚‹ã€‚


3 æ‰‹æ³•



3.1 Cognitive Preference Optimization

æ‰‹æ³•å…¨ä½“ã®æµã‚Œã‚’å›³ 2 ã«ç¤ºã™ã€‚
Step1: è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®å­¦ç¿’ã¾ãšã€ã‚ã‚‹æ–‡æ›¸ã‚’èª­ã‚“ã§ã„ã‚‹éš›ã® EEG ç‰¹å¾´ç³»åˆ—ã‚’ ğ‘¿ =(ğ’™1, ğ’™2, . . . , ğ’™ğ‘‡)ã¨è¡¨ã—ã€å„ ğ’™ğ‘¡âˆˆ â„ğ‘šã¯æ–‡æ›¸ä¸­ã®å˜èª ğ‘¡ ã«å¯¾å¿œã™ã‚‹ EEG ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã¨ã™ã‚‹ã€‚
æ–‡æ›¸ã®å˜èªæ•°ã‚’ ğ‘‡ ã¨ã™ã‚‹ã€‚
è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã¯ã“ã® EEG ç³»åˆ—ã‚’å…¥åŠ›ã¨ã—ã€ã‚¹ã‚«ãƒ©ãƒ¼å€¤ã‚’å‡ºåŠ›ã™ã‚‹é–¢æ•° ğ‘ ğœ™( ğ‘¿) âˆˆ â„ ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚
ã“ã“ã§ã€ğœ™ ã¯ãƒ‡ã‚³ãƒ¼ãƒ€ã®å­¦ç¿’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚ã‚‹ã€‚
å­¦ç¿’ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦ã€ã€Œå¥½ã¾ã—ã„(chosen)ã€ã¨ã€Œå¥½ã¾ã—ããªã„(rejected)ã€ã®æ–‡æ›¸ãƒšã‚¢ã‚’nî˜€ğ‘¿(ğ‘–)chosen, ğ‘¿(ğ‘–)rejectedî˜oğ‘ğ‘–=1ã®å½¢ã§ç”¨æ„ã™ã‚‹ã€‚
ğ‘– ç•ªç›®ã®ãƒšã‚¢ã«å¯¾ã—ã¦è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ãŒå‡ºåŠ›ã™ã‚‹ã‚¹ã‚³ã‚¢ã‚’ ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)chosenî˜, ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)rejectedî˜ã¨ã—ã€ãã®å·®ã‚’scorediï¬€(ğ‘–)= ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)chosenî˜âˆ’ ğ‘ ğœ™î˜€ğ‘¿(ğ‘–)rejectedî˜ã¨å®šç¾©ã™ã‚‹ã€‚
è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®ç›®æ¨™ã¯ã€chosen ã®ã»ã†ãŒrejected ã‚ˆã‚Šã‚‚é«˜ã„ã‚¹ã‚³ã‚¢ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨ã§ã‚ã‚Šã€ã“ã®æ¡ä»¶ã‚’æº€ãŸã™ã‚ˆã†ã«æ¬¡ã®æå¤±é–¢æ•°ã‚’æœ€å°åŒ–ã™ã‚‹ï¼šL(ğœ™) =ğ‘Ã•ğ‘–=1logî˜1+expî˜€âˆ’î˜‚ğ‘ ğœ™( ğ‘¿(ğ‘–)chosen)âˆ’ğ‘ ğœ™( ğ‘¿(ğ‘–)rejected)î˜ƒî˜î˜‘.(1)ã“ã®æå¤±ã‚’æœ€å°åŒ–ã™ã‚‹ã“ã¨ã§ã€è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã¯chosen ã‚’é«˜ãã€rejected ã‚’ä½ãã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã™ã‚‹ã‚ˆã†å­¦ç¿’ã•ã‚Œã‚‹ã€‚
Step2: èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®åé›†æ¬¡ã«ã€å­¦ç¿’ã—ãŸè„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã‚’ç”¨ã„ã¦èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®åé›†ã‚’è¡Œã†ã€‚
Step1 ã§ã¯ãƒ‡ã‚³ãƒ¼ãƒ€ã®æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦é¸å¥½ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ã§ã‚ã£ãŸãŒã€Step2 ã§ã¯è„³æ³¢ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‹ã‚‰èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åé›†ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã‚ã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€ã‚ã‚‹äºŒã¤ã®æ–‡ç« ã«å¯¾ã—ã¦è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã‚’ç”¨ã„ã¦ã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã™ã‚‹ã€‚
ã‚¹ã‚³ã‚¢ãŒé«˜ã„æ–‡ç« ã‚’ chosenã€ã‚¹ã‚³ã‚¢ãŒä½ã„æ–‡ç« ã‚’ rejected ã¨ã¿ãªã—ã€ã“ã‚Œã‚‰ã®æ–‡ç« ãƒšã‚¢ã¨å¯¾å¿œã™ã‚‹é¸å¥½æƒ…å ±ã‚’åé›†ã™ã‚‹ã€‚
ã“ã®æ–¹æ³•ã«ã‚ˆã‚Šã€å¾“æ¥å¿…è¦ã¨ã•ã‚Œã¦ã„ãŸäººé–“ã«ã‚ˆã‚‹é¸å¥½ãƒ©ãƒ™ãƒ«ä»˜ã‘ã®æ‰‹é–“ã‚’å‰Šæ¸›ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚‹ã€‚
Step3: èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ã DPOStep3 ã§ã¯ã€Step2 ã§åé›†ã—ãŸé¸å¥½ãƒ‡ãƒ¼ã‚¿ï¼ˆèªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼‰ã‚’ç”¨ã„ã¦ã€DPO ã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ã®æœ€é©åŒ–ã‚’è¡Œã†ã€‚
DPO ã¯ã€å‚ç…§ãƒ¢ãƒ‡ãƒ«ã¨æ¯”è¼ƒã—ã¦ã€å¥½ã¾ã—ã„å‡ºåŠ›ãŒé¸æŠã•ã‚Œã‚‹ç¢ºç‡ã‚’æœ€å¤§åŒ–ã™ã‚‹ã‚ˆã†ã«ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹æ‰‹æ³•ã§ã‚ã‚Šã€å ±é…¬ãƒ¢ãƒ‡ãƒ«ãªã—ã§ã€é¸å¥½ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç›´æ¥æœ€é©åŒ–ã‚’è¡Œã†ã“ã¨ãŒã§ãã‚‹ã€‚
å…·ä½“çš„ã«ã¯ã€ãƒ¢ãƒ‡ãƒ« ğœ‹ğœƒã®æ¡ä»¶ä»˜ãç¢ºç‡åˆ†å¸ƒã¨å‚ç…§ãƒ¢ãƒ‡ãƒ« ğœ‹refã®æ¡ä»¶ä»˜ãç¢ºç‡åˆ†å¸ƒã‚’ç”¨ã„ã¦ã€æ¬¡ã®æå¤±é–¢æ•°ã‚’æœ€å°åŒ–ã™ã‚‹ï¼šLDPO( ğœƒ ) = âˆ’1ğ‘ğ‘Ã•ğ‘–=1log ğœÂ©îš­îš­Â«ğ›½Â©îš­îš­Â«logğœ‹ğœƒ(ğ’š(ğ‘–)chosen|ğ’™(ğ‘–))ğœ‹ref(ğ’š(ğ‘–)chosen|ğ’™(ğ‘–))
âˆ’ logğœ‹ğœƒ(ğ’š(ğ‘–)rejected|ğ’™(ğ‘–))ğœ‹ref(ğ’š(ğ‘–)rejected|ğ’™(ğ‘–))ÂªÂ®Â®Â¬ÂªÂ®Â®Â¬,(2)ã“ã‚Œã«ã‚ˆã‚Šã€Step2 ã§å¾—ã‚‰ã‚ŒãŸèªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’æ´»ç”¨ã—ã€ç”Ÿæˆãƒ¢ãƒ‡ãƒ«ã‚’è¢«é¨“è€…ã®é¸å¥½ã«é©åˆã•ã›ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚‹ã€‚



3.2 é¸å¥½ãƒšã‚¢ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ

ä½¿ç”¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæœ¬å®Ÿé¨“ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ã—ã¦ Zurich Cognitive Language Processing Corpus(ä»¥ä¸‹ ZuCo)[12]ã«åéŒ²ã•ã‚Œã¦ã„ã‚‹SentimentReading (SR)ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç”¨ã„ãŸã€‚
ã“ã®ã‚³ãƒ¼ãƒ‘ã‚¹ã¯ã‚¢ã‚¤ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã¨ EEG ã®è¨˜éŒ²ã‚’åŒæ™‚ã«è¡Œã£ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã‚ã‚Šã€12 äººã®è¢«é¨“è€…ã«ã‚ˆã£ã¦èª­ã¾ã‚ŒãŸç´„ 400 æ–‡ã‚’å«ã‚€ã€‚
æ–‡ç« ã¯å…¨ã¦æ˜ ç”»ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼æ–‡ã§ã‚ã‚Šã€Stanford SentimentTreebank (SST)ã‹ã‚‰æŠ½å‡ºã•ã‚ŒãŸã‚‚ã®ã§ã‚ã‚‹ã€‚
è„³æ³¢ã¯è¦–ç·šãƒ‡ãƒ¼ã‚¿ï¼ˆGaze Durationï¼‰ã«åŸºã¥ã„ã¦æŠ½å‡ºã—ã¦ãŠã‚Šã€840 æ¬¡å…ƒã®ãƒ™ã‚¯ãƒˆãƒ«ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ã€‚
ãƒšã‚¢ãƒ‡ãƒ¼ã‚¿ã¸ã®å¤‰æ›æœ¬ç ”ç©¶ã§ã¯ã€ZuCo SRãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç”¨ã„ã¦ãƒšã‚¢ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ã€‚
ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯ã€SSTï¼ˆStanford SentimentTreebankï¼‰[13]ãŒä½œæˆã•ã‚ŒãŸéš›ã«ä»˜ä¸ã•ã‚ŒãŸGround Truth ãƒ©ãƒ™ãƒ«ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€400 æ–‡ã®ã†ã¡ 140 æ–‡ãŒ positiveã€137 æ–‡ãŒ neutralã€123 æ–‡ãŒnegative ã«åˆ†é¡ã•ã‚Œã‚‹ã€‚
ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ã‚’é˜²ããŸã‚ã€ã“ã‚Œã‚‰ã®ãƒ©ãƒ™ãƒ«åˆ†å¸ƒã‚’ç¶­æŒã—ãŸã¾ã¾ã€10-foldã«åˆ†å‰²ã—ã¦ãƒšã‚¢ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ã€‚
ãƒšã‚¢ä½œæˆã®éš›ã«ã¯ã€positive > neutral ã®é–¢ä¿‚ã€ã•ã‚‰ã« positive> negative ã®é–¢ä¿‚ã«åŸºã¥ã„ã¦ãƒšã‚¢ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚
ç†è«–ä¸Šã€positive ãªæ–‡ã¨ neutral ãªæ–‡ã®çµ„ã¿åˆã‚ã›æ•°ã€ã‚ã‚‹ã„ã¯ positive ãªæ–‡ã¨ negative ãªæ–‡ã®çµ„ã¿åˆã‚ã›æ•°ã«åŸºã¥ãæœ€å¤§ã®ãƒšã‚¢ã‚’ä½œæˆå¯èƒ½ã§ã‚ã‚‹ãŒã€è¨“ç·´æ™‚ã«ã¯å„æ–‡ã«ã¤ãæœ€å¤§ 5 ãƒšã‚¢ã®ã¿ã‚’ä½œæˆã™ã‚‹ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿å…¨ä½“ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ä½ä¸‹ã«ã‚ˆã‚‹éå­¦ç¿’ã‚’é˜²ãã€‚
ä¸€æ–¹ã€ãƒ†ã‚¹ãƒˆæ™‚ã«ã¯å¯èƒ½ãªé™ã‚Šã™ã¹ã¦ã®ãƒšã‚¢ã‚’ç”Ÿæˆã™ã‚‹ã€‚
è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®å­¦ç¿’ã¯ 10 åˆ†å‰²äº¤å·®æ¤œè¨¼ã«ã‚ˆã‚Šè¡Œã„ã€å„fold ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«ãŠã‘ã‚‹çµæœã§ã‚ã‚‹å…¨ 3640ä»¶ã‚’èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ã€‚
ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®å–å¾— ZuCo SRãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å«ã¾ã‚Œã‚‹ 400 æ–‡ã®ã†ã¡ã€47 æ–‡ã«ã¯è¢«é¨“è€…ãŒå›ç­”ã—ãŸæ„Ÿæƒ…ãƒ©ãƒ™ãƒ«ï¼ˆ5 æ®µéšè©•ä¾¡ï¼‰ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ã€‚
ã“ã‚Œã‚‰ã® 47 æ–‡ã®å†…è¨³ã¯ã€Ground Truth ãƒ©ãƒ™ãƒ«ã§ positive ãŒ 22 æ–‡ã€neutral ãŒ6 æ–‡ã€negative ãŒ 17 æ–‡ã§ã‚ã‚‹ã€‚
Ground Truth ã®ãƒ©ãƒ™ãƒ«ã«åŸºã¥ãã€ã“ã‚Œã‚‰ã® 47 æ–‡ã‹ã‚‰è¨ˆ 506 ãƒšã‚¢ã‚’ä½œæˆã™ã‚‹ã€‚
ä½œæˆã•ã‚ŒãŸãƒšã‚¢ã«å¯¾ã—ã¦ã€è¢«é¨“è€…ãŒä»˜ä¸ã—ãŸ 5 æ®µéšã®æ„Ÿæƒ…ãƒ©ãƒ™ãƒ«ã‚’åŸºã«é¸å¥½æƒ…å ±ã‚’æ§‹ç¯‰ã—ã€ã“ã‚Œã‚’ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ã—ã¦åˆ©ç”¨ã™ã‚‹ã€‚
ãªãŠã€ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¯èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«æ¯”ã¹ã¦ãƒ‡ãƒ¼ã‚¿æ•°ãŒå°‘ãªã„ãŸã‚ã€ä¸¡è€…ã‚’æ¯”è¼ƒã™ã‚‹éš›ã«ã¯ã€èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã®ä¸­ã‹ã‚‰åŒã˜ 506 ä»¶ã®ãƒ†ã‚­ã‚¹ãƒˆãƒšã‚¢ã‚’æŠ½å‡ºã—ã¦ä½¿ç”¨ã™ã‚‹ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ãŒç•°ãªã‚‹ã“ã¨ã«ã‚ˆã‚‹å½±éŸ¿ã‚’æ’é™¤ã—ã€ãƒ•ã‚§ã‚¢ãªæ¯”è¼ƒã‚’è¡Œã†ã€‚

3.3 å­¦ç¿’è¨­å®š

ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã¨ã—ã¦ã€[5]ã‚’å‚è€ƒã«ã€å°è¦æ¨¡ãª Transformer ã‚’ç”¨ã„ãŸã€‚
ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€äº‹å‰ã«ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒã‚’ç”¨ã„ã¦æ±ºå›³ 2: ææ¡ˆæ‰‹æ³•ã®å…¨ä½“ã®æµã‚Œã®æ¦‚è¦å›³ã€‚
è„³æ³¢ãƒ‡ãƒ¼ã‚¿ã®ãƒ‡ã‚³ãƒ¼ãƒ€ã‚’å­¦ç¿’ã™ã‚‹éš›ã«ã¯æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦é¸å¥½ãƒ©ãƒ™ãƒ«ãŒå¿…è¦ã«ãªã‚‹ãŒã€èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¯è„³æ³¢ã®ã¿ã‹ã‚‰åé›†ã™ã‚‹ã“ã¨ãŒã§ãã€ä½œæ¥­è€…ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã‚€ã ã‘ã§ã‚ˆã„ã€‚
å®šã—ãŸã€‚
num layers ã¯ 2ã€nhead ã‚’ 8ã€dmodel ã‚’512ã€dim feedforward ã‚’ 2048 ã«è¨­å®šã—ã¦å®Ÿé¨“ã‚’è¡Œã£ãŸã€‚
ã¾ãŸã€ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ã€IMDbãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ[14]ã§ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æ¸ˆã¿ã® GPT-2 medium1ï¼‰ã‚’ç”¨ã„ãŸã€‚
ä»¥é™ã“ã‚Œã‚’ SFT ãƒ¢ãƒ‡ãƒ«ã¨å‘¼ã¶ã€‚
IMDb ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ SST ã¨åŒæ§˜ã«æ˜ ç”»ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§æ§‹æˆã•ã‚Œã¦ã„ã‚‹ãŒã€ä¸¡è€…ã¯ç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«ä½œæˆã•ã‚ŒãŠã‚Šãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ã®æ‡¸å¿µã¯ãªã„ã€‚
ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡ä½œæˆã—ãŸãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡ã§ã¯ã€SST ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ä¸­ã‹ã‚‰ã€ZuCo SR ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«åéŒ²ã•ã‚Œã¦ã„ãªã„ä¾‹ã‚’ã€neutral æ–‡ã‚’ 50ã€negative æ–‡ã‚’ 50 æŠ½å‡ºã—ã€ãã‚Œã‚‰ã®åˆæœŸ 10 å˜èªã®ã¿ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®å…¥åŠ›ã¨ã—ã¦ä¸ãˆã€ç¶šãã‚’ç”Ÿæˆã•ã›ãŸã€‚
ç”Ÿæˆã•ã›ãŸæ–‡ç« ã«ã¤ã„ã¦ã€gpt-4o-2024-11-20 ã«ã‚ˆã‚‹ llm-as-a-judge ã‚’å®Ÿæ–½ã—ãŸã€‚
ã‚ˆã‚Šãƒã‚¸ãƒ†ã‚£ãƒ–ãªæ–‡ç« ã‚’å‡ºåŠ›ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’é¸ã°ã›ã€ãã‚Œã«åŸºã¥ã 2 ãƒ¢ãƒ‡ãƒ«é–“ã® Win1ï¼‰ https://huggingface.co/edbeeching/gpt2-medium-imdbå›³ 3: ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚ºã”ã¨ã®è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®æ€§èƒ½å›³ 4: èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®æ€§èƒ½æ¯”è¼ƒRate ã‚’ç®—å‡ºã™ã‚‹ã“ã¨ã§ã€ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡ã‚’è¡Œã£ãŸã€‚



4 çµæœ

è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®æ€§èƒ½ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚ºã”ã¨ã®è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã®æ€§èƒ½ã®çµæœã®ä¸€éƒ¨ã‚’å›³ 3 ã«ç¤ºã—ãŸã€‚
é©åˆ‡ãªãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚ºã«ãŠã„ã¦ã¯ Ground Truth ã«å¯¾ã™ã‚‹æ­£è§£ç‡ãŒãƒãƒ£ãƒ³ã‚¹ãƒ¬ãƒ™ãƒ«ã‚’å¤§ããä¸Šå›ã£ã¦ãŠã‚Šã€è„³æ³¢ã®æŒã¤æƒ…å ±ã‹ã‚‰ã‚ã‚‹ç¨‹åº¦é©åˆ‡ã«é¸å¥½æƒ…å ±ãŒãƒ‡ã‚³ãƒ¼ãƒ‰ã§ãã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹ã€‚
èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ vs. ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨äººæ‰‹ã§ä½œæˆã•ã‚ŒãŸãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ã§ã€ãã‚Œãã‚Œä½œæˆã•ã‚ŒãŸãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½æ¯”è¼ƒã‚’å›³4 ã«ç¤ºã—ãŸã€‚
äºŒã¤ã®ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã‚’ç›´æ¥æ¯”è¼ƒã—ãŸå ´åˆã ã¨å·®ãŒå‡ºãªã‹ã£ãŸãŒã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã§ã‚ã‚‹ SFT ãƒ¢ãƒ‡ãƒ«ã¨ã®æ¯”è¼ƒã§ã¯ã€CPO ã«ã‚ˆã‚Šä½œæˆã—ãŸãƒ¢ãƒ‡ãƒ«ãŒã‚ãšã‹ã«ä¸Šå›ã£ãŸã€‚
ãã‚Œãã‚Œã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚¿ã‚¤ãƒ—ã«ãŠã„ã¦ã©ã®ã‚ˆã†ã«ç•°ãªã‚‹ã®ã‹ã‚’ã€ä»Šå¾Œã®åˆ†æã§æ˜ã‚‰ã‹ã«ã—ãŸã„ã€‚
ææ¡ˆæ‰‹æ³•ã®ã‚¹ã‚±ãƒ¼ãƒ«æ€§ã®æ¤œè¨¼ä»Šå›ã€ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®è¨“ç·´ã«ä½¿ç”¨ã§ãã‚‹è„³æ³¢ã‹ã‚‰ä½œæˆã—ãŸé¸å¥½ãƒšã‚¢ã¯åˆè¨ˆã§ 3640 ä»¶ã§ã‚ã‚Šã€æ¯”è¼ƒçš„å°è¦æ¨¡ã§ã‚ã‚‹ã€‚
å­¦ç¿’ã«ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ä»¶æ•°ãŒå¤šã„å›³ 5: ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’ã«ç”¨ã„ã‚‹é¸å¥½ãƒšã‚¢ã®æ•°ã¨ã€ãã®ãƒšã‚¢æ•°ã§å­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã®æ¨ç§»ã»ã©æœ€çµ‚çš„ãªãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚‚è‰¯ããªã‚‹ã®ã§ã‚ã‚Œã°ã€ä»Šå¾Œã•ã‚‰ã«å¤šãã®è„³æ³¢ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ã•ã‚‰ã«æ€§èƒ½ã®é«˜ã„ãƒ¢ãƒ‡ãƒ«ãŒä½œæˆã§ãã‚‹ã¨æœŸå¾…ã•ã‚Œã‚‹ã€‚
å›³ 5 ã§ã¯ãƒšã‚¢æ•°ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ã¦ä½œæˆã—ãŸè¤‡æ•°ã®ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚’æ¯”è¼ƒã—ã¦ãŠã‚Šã€ææ¡ˆæ‰‹æ³•ã®ã‚¹ã‚±ãƒ¼ãƒ«æ€§ã®æ¤œè¨¼ã‚’è¡Œãªã£ãŸã€‚
ä»Šå›ã®æ¤œè¨¼ã®ç¯„å›²å†…ã§ã¯ã‚ˆã‚Šå¤šãã®ãƒšã‚¢ã‚’ç”¨ã„ã‚‹ã»ã©ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã‚‚æ”¹å–„ã—ã¦ãŠã‚Šã€ã‚ˆã‚Šå¤šãã®è„³æ³¢ãƒ‡ãƒ¼ã‚¿ãŒã•ã‚‰ãªã‚‹æ”¹å–„ã‚’ã‚‚ãŸã‚‰ã™å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã‚’ç¤ºå”†ã™ã‚‹çµæœã¨ãªã£ãŸã€‚



5 ãŠã‚ã‚Šã«

æœ¬ç ”ç©¶ã§ã¯ã€è„³æ³¢ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦é¸å¥½æƒ…å ±ã‚’åé›†ã—ã€å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã‚’ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–ã™ã‚‹ãŸã‚ã®æ–°ã—ã„æ‰‹æ³•ã‚’ææ¡ˆã—ãŸã€‚
å…·ä½“çš„ã«ã¯ã€è„³æ³¢ãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«é¸å¥½æƒ…å ±ã‚’æ¨å®šã™ã‚‹è„³æ³¢ãƒ‡ã‚³ãƒ¼ãƒ€ã‚’æ§‹ç¯‰ã—ã€ã“ã‚Œã‚’æ´»ç”¨ã—ã¦èªçŸ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åé›†ã—ã€DPO (Direct PreferenceOptimization)ã«åŸºã¥ããƒ¢ãƒ‡ãƒ«ã®æœ€é©åŒ–ã‚’è¡Œã£ãŸã€‚
å®Ÿé¨“ã®çµæœã€ææ¡ˆæ‰‹æ³•ã‚’ç”¨ã„ãŸãƒ¢ãƒ‡ãƒ«ã¯ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨æ¯”è¼ƒã—ã¦ã‚ˆã‚Šãƒã‚¸ãƒ†ã‚£ãƒ–ãªå‡ºåŠ›ã‚’ç”Ÿæˆã™ã‚‹ãƒãƒªã‚·ãƒ¼æœ€é©åŒ–ãŒå¯èƒ½ã§ã‚ã‚‹ã“ã¨ãŒç¤ºã•ã‚ŒãŸã€‚
ã¾ãŸã€æ‰‹å‹•ã§ä½œæˆã—ãŸãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ç”¨ã„ãŸå ´åˆã¨æ¯”ã¹ã¦ã‚‚ã€ææ¡ˆæ‰‹æ³•ã®æ€§èƒ½ã¯åŒç­‰ç¨‹åº¦ã§ã‚ã‚‹ã“ã¨ãŒç¢ºèªã•ã‚ŒãŸã€‚
ä»Šå¾Œã®èª²é¡Œã¨ã—ã¦ã€ç”Ÿæˆã•ã‚ŒãŸå‡ºåŠ›ä¾‹ã®ã•ã‚‰ãªã‚‹åˆ†æã‚’è¡Œã„ã€ææ¡ˆæ‰‹æ³•ãŒã©ã®ã‚ˆã†ã«ãƒ¢ãƒ‡ãƒ«ã®é¸å¥½ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã®ã‹ã‚’è©³ç´°ã«æ¤œè¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
ã¾ãŸã€é©ç”¨ç¯„å›²ã®æ‹¡å¤§ã‚„ã€ã‚ˆã‚Šå¤§è¦æ¨¡ãªãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ãŸå®Ÿé¨“ã‚‚è¡Œã„ã€æ‰‹æ³•ã®å¦¥å½“æ€§ã‚’ã‚ˆã‚Šæ·±ãæ¤œè¨¼ã—ã¦ã„ããŸã„ã€‚



è¬è¾

æœ¬ç ”ç©¶ã¯ã€JST ã•ããŒã‘ JPMJPR21C2 ãŠã‚ˆã³JSPS ç§‘ç ”è²» 24H00087 ã®æ”¯æ´ã‚’å—ã‘ãŸã‚‚ã®ã§ã™ã€‚

å‚è€ƒæ–‡çŒ®


[1] Rafael Rafailov, Archit Sharma, Eric Mitchell,Christopher D Manning, Stefano Ermon, and ChelseaFinn. Direct preference optimization: Your languagemodel is secretly a reward model. Advances in Neu-ral Information Processing Systems, Vol. 36, ,2024.
[2] Melody Y Guan, Manas Joglekar, Eric Wallace,Saachi Jain, Boaz Barak, Alec Heylar, Rachel Dias,Andrea Vallone, Hongyu Ren, Jason Wei, et al. Delib-erative alignment: Reasoning enables safer languagemodels. arXiv preprint arXiv:2412.16339, 2024.
[3] Nisan Stiennon, Long Ouyang, Jeï¬€rey Wu, DanielZiegler, Ryan Lowe, Chelsea Voss, Alec Radford,Dario Amodei, and Paul F Christiano. Learning tosummarize with human feedback. Advances in Neu-ral Information Processing Systems, Vol. 33, pp.3008â€“3021, 2020.
[4] Harrison Lee, Samrat Phatale, Hassan Mansoor, KellieLu, Thomas Mesnard, Colton Bishop, Victor Carbune,and Abhinav Rastogi. Rlaif: Scaling reinforcementlearning from human feedback with ai feedback. arXive-prints, pp. arXivâ€“2309, 2023.
[5] Alex Murphy, Bernd Bohnet, Ryan McDonald, andUta Noppeney. Decoding part-of-speech from hu-man EEG signals. In Smaranda Muresan, PreslavNakov, and Aline Villavicencio, editors, Proceedingsof the 60th Annual Meeting of the Associationfor Computational Linguistics (Volume 1: LongPapers), pp. 2201â€“2210, Dublin, Ireland, May 2022.Association for Computational Linguistics.
[6] Michalina Strzyz, David Vilares, and Carlos GÂ´omez-RodrÂ´Ä±guez. Towards making a dependency parser see,2019.
[7] Maria Barrett, Joachim Bingel, Nora Hollenstein,Marek Rei, and Anders SÃ¸gaard. Sequence classi-ï¬cation with human attention. In Anna Korhonen andIvan Titov, editors, Proceedings of the 22nd Con-ference on Computational Natural LanguageLearning, pp. 302â€“312, Brussels, Belgium, October2018. Association for Computational Linguistics.
[8] Nora Hollenstein and Ce Zhang. Entity recognition atï¬rst sight: Improving NER with eye movement infor-mation. In Jill Burstein, Christy Doran, and ThamarSolorio, editors, Proceedings of the 2019 Con-ference of the North American Chapter of theAssociation for Computational Linguistics: Hu-man Language Technologies, Volume 1 (Longand Short Papers), pp. 1â€“10, Minneapolis, Min-nesota, June 2019. Association for Computational Lin-guistics.
[9] Yuqi Ren and Deyi Xiong. CogAlign: Learning toalign textual neural representations to cognitive lan-guage processing signals. In Chengqing Zong, FeiXia, Wenjie Li, and Roberto Navigli, editors, Pro-ceedings of the 59th Annual Meeting of the As-sociation for Computational Linguistics and the11th International Joint Conference on NaturalLanguage Processing (Volume 1: Long Papers),pp. 3758â€“3769, Online, August 2021. Association forComputational Linguistics.
[10] Nora Hollenstein, Maria Barrett, Marius Troendle,Francesco Bigiolli, Nicolas Langer, and Ce Zhang.Advancing nlp with cognitive language processing sig-nals, 2019.
[11] Ekta Sood, Simon Tannert, Philipp Mueller, and An-dreas Bulling. Improving natural language processingtasks with human gaze-guided neural attention. InH. Larochelle, M. Ranzato, R. Hadsell, M.F. Balcan,and H. Lin, editors, Advances in Neural Informa-tion Processing Systems, Vol. 33, pp. 6327â€“6341.Curran Associates, Inc., 2020.
[12] Nora Hollenstein, Jonathan Rotsztejn, Marius Troen-dle, Andreas Pedroni, Ce Zhang, and Nicolas Langer.Zuco, a simultaneous eeg and eye-tracking resourcefor natural sentence reading. Scientiï¬c data, Vol. 5,No. 1, pp. 1â€“13, 2018.
[13] Richard Socher, Alex Perelygin, Jean Wu, JasonChuang, Christopher D. Manning, Andrew Ng, andChristopher Potts. Recursive deep models for seman-tic compositionality over a sentiment treebank. InProceedings of the 2013 Conference on Empir-ical Methods in Natural Language Processing,pp. 1631â€“1642, Seattle, Washington, USA, October2013. Association for Computational Linguistics.
[14] Andrew L. Maas, Raymond E. Daly, Peter T. Pham,Dan Huang, Andrew Y. Ng, and Christopher Potts.Learning word vectors for sentiment analysis. In Pro-ceedings of the 49th Annual Meeting of theAssociation for Computational Linguistics: Hu-man Language Technologies, pp. 142â€“150, Port-land, Oregon, USA, June 2011. Association for Com-putational Linguistics.