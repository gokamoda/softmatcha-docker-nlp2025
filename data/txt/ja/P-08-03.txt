事故事例文書絞り込み検索システムの構築

福岡康大

1

 大八木悠聖

1

 喜多俊介

1

深草理貴

1

 森辰則

1

 伊藤拓海

2

 小野寺理恵

21

横浜国立大学大学院

2

株式会社 IHI



fukuoka-kodai-hr@ynu.jp ooyagi-yuusei-kn@ynu.jp kita-shunsuke-yz@ynu.jp



fukagusa-riki-wf@ynu.jp tmori@ynu.ac.jp ito9762@ihi-g.com onodera3892@ihi-g.com



概要

本研究では、事故・不具合問い合わせの解析・類似事例の検索・回答文の生成といった作業を自動で行うシステムの実現を目指しており、本稿では、現場からの問い合わせに対し、企業に蓄積されている文書から目的の類似事例を得るための絞り込み手法を提案する。
製造業の企業における現場からの問い合わせは抽象的であるため、問い合わせ意図を検索結果に反映することが難しく、1 度の問い合わせで目的の類似事例文書を得ることは難しい。
そのため、本稿では、現場利用者の情報要求に応じた類似事例文書を得るために、事故事例文書の絞り込みを行うシステムを構築することを目的とし、問い合わせ文からの問い合わせ意図推定、システムが能動的に行う質問に対してユーザが回答文を入力するやり取りの中でのスロットフィリング、スロットフィリングで得られた情報をもとにリランキングを行い絞り込みを行う手法を提案する。
また、提案手法の有効性を検証するために、提案手法を扱うシステムを作成し評価実験を行った。
抽象的な問い合わせ文を入力とし、提示する質問に回答していくことで、正解文書が初期の検索結果でのランクよりも上位にリランキングされることを確認した。


1 はじめに

製造業の企業では、現場で技術的な問題や事故・装置の不具合が発生した場合、担当部署に対して対処方法について問い合わせが行われ、担当部署が過去の類似事例を参考にして回答を返し問題解決を図る、というプロセスが取られることが多い。
しかし、部署の担当者が、1O問い合わせ文章の読解、2O過去の事故不具合事例データベースからの前例の検索、3O回答文章の作成、といった作業を人手で行っており、非効率的だという現状がある。
そのため、1O事故・不具合問い合わせ文書の解析、2Oデータベースからの類似事例の検索、3O回答文章の生成、といった作業を自動で行うことのできるシステムに対して需要が大きい。
本研究では上記の問い合わせ対応作業を自動で行うシステムの実現を目標としている。
しかし、現場からの問い合わせは抽象的であるため、問い合わせ意図を検索結果に反映することが難しく、1 度の問い合わせで、問い合わせに対する回答を生成するための類似事例文書を得ることは難しい。
上記システムの実現には、システムとユーザの対話により得た情報を用いた類似事例の絞り込みが必要である。
本稿では、現場利用者の情報要求に応じた類似事例文書を得るために、事故事例文書の絞り込みを行うシステムを構築することを目的とし、問い合わせ文からの問い合わせ意図推定、システムが能動的に行う質問に対してユーザが回答文を入力するやり取りの中でのスロットフィリング、スロットフィリングで得られた情報をもとにリランキングを行い絞り込みを行う手法を提案する。
また、この手法の有効性を検証するために、実際に絞り込みを行うシステムを構築し、システムに対する評価実験を行う。



2 関連研究



2.1 フィードバックによるリランキング

検索結果を改善する方法として、畠中ら[1]は、適合性フィードバックを用いてユーザのフィードバックを得る手法を提案しており、初期検索結果から適合文書と不適合文書をユーザに選んでもらうことで検索結果のリランキングを行うことができるが、適合性フィードバックを利用する場合の問題点として、ユーザの負担が大きくなってしまうことが挙げられる。
検索結果集合から目的の文書を絞り込むことを目的とした研究として、尾崎[2]らの研

究では、検索結果集合の特許文書に含まれる課題を表すフレーズを選択肢とする複数の質問を生成し、ユーザからの回答を得ることで、目的とする特許文書が検索結果の上位に現れるように検索結果集合をリランキングする手法を提案している。
これに対し、事故事例文書の絞り込みにおいては、現場の環境や事故の対象物など、より具体的な情報を取得する必要があると考えられるため、システムが能動的に行う質問に対してユーザが回答文を入力することで情報を取得する手法がより適していると考える。

2.2 スロットフィリング

システムとユーザのやり取りの中で、問い合わせの意図や、より具体的な情報を取得し、活用するための研究として意図推定やスロットフィリングに関する研究が行われており、Zeng ら[3]は、典型的なタスク指向対話システムにおける言語理解のための意図推定やスロットフィリングを可能とする手法を提案している。
本研究においては、汎用的な対話システムではなく、製造業の問い合わせに特化した問い合わせ対応システムの構築を目的としているため、そのような問い合わせの特徴を考慮した意図やスロットの設定を行うことが有効であると考えられる。


2.3 本研究の位置付け

本稿では製造業の問い合わせに特化した検索事例絞り込みシステムの実現のために、上記の関連研究を参考にし、「質問によるフィードバックとスロットフィリング」と「スロットフィリング結果に基づくリランキング」を用いた絞り込みの枠組みを新たに検討する。
関連研究との異なる点は、製造業における問い合わせの特徴を分析し、分析結果をもとに意図やスロットの設定を行う点である。
また、得られたスロット値によるリランキングのためのスロットフィリングを行うために、システムが能動的に行う質問に対してユーザが回答文を入力するやり取りを行うことで、ユーザの負担を少なくしながら絞り込みを行う手法を新たに提案する点である。


3 提案手法



3.1 事故事例文書絞り込み手法の概要

事故事例文書絞り込み手法について、本稿では、製造業における問い合わせの特徴分析による意図やスロットの設定を行い、スロットフィリングを行うためにシステムが能動的に行う質問に対してユーザが回答文を入力するやり取りを行うことで、得られたスロット値によるリランキングをし、ユーザの負担を少なくしながら絞り込みを行う手法を提案する。
提案手法の概要を図 1 に示す。
図 1 提案手法の概要図

3.2 問い合わせ意図推定

最初の処理として、入力された問い合わせ文から問い合わせ意図推定を行う。
まず、製造業における現場からの問い合わせは大きく分けて、起こった事故に関する問い合わせである「事故後の対応」と、作業前など何かを行う前の確認に関する問い合わせである「事前の確認」の二つのタイプに分けられる。
また、「事故後の対応」を問い合わせる意図としては「トラブル解決」、「原因推定」があり、「事前の確認」として問い合わせる意図には「安全確保」、「トラブル予防」、「作業効率化」、「品質向上」がある。
そのため、この処理においては、受け付けた問い合わせが「事故後の対応」、「事前の確認」のどちらのタイプなのかの判定をまず行い、その後、それぞれのタイプにおける問い合わせの意図として、以上の項目のいずれであるかの分類を行うことで、問い合わせ意図推定を行う。
意図推定の結果は、スロットフィリングのためにシステムが行う質問の選択処理に活用される。



3.3 スロットの仕様

本稿の提案手法では、事例をスロット名とスロット値の集合の情報構造で表現し、ユーザからのフィードバックから得られる情報でスロットフィリ

ングを行うことで、類似事例の絞り込みに使用するスロット値を得るようにする。
そのため、絞り込みの対象である事故事例の分析を行ない、スロットの設定を検討した。
分析の結果、事故事例からは大きく分けて対象物、環境、事故(事故の内容)、作業(そのときにやっていたこと)の情報が得られ、これらが事故事例の大まかな概要をあたえるようになっていることがわかり、事故事例の絞り込みを行うための情報として有効であると考えられる。
以上の分析から検討した、提案手法における詳細なスロットを図 2 に示す。
また、各スロットに対応するスロット値の例を図 2 の右に示す。
図 2 提案手法におけるスロットとスロット値の例システムは、スロットを埋めるための質問を提示し、ユーザからフィードバックをうけるという対話の中で対応するスロット値を埋めるスロットフィリングを行い、埋めたスロット値を検索結果の絞り込みに活用する。

3.4 システムから提示する質問

システムから提示するスロットを埋めるための質問文は、それぞれのスロットに対応してあらかじめ用意しておくことにする。
また、意図推定の結果、図 1 の処理の流れの青枠の部分のように、問い合わせ意図が「事前の確認」,「安全確保」であると推定された場合は「作業」に関するスロットを優先で埋めるといったように、意図推定の結果に応じた埋めるべきスロットの優先順位をあらかじめ定めておく。
そして、その時点で埋まっていないスロットの優先順位を加味し、提示する質問文を選択する。
ここでは、図 1 の処理の流れの赤枠の部分のように、システムから「具体的な作業内容を教えてください」という質問文が提示され、ユーザが「清掃作業を行います」と回答することで、”作業。
作業内容”のスロットに「清掃作業」というスロット値を埋めるような処理が行われることを想定している。
また、提示する質問に対するユーザの回答により、目的のスロットを正しく埋めるため、システムから提示する文には、それぞれの質問文に対するユーザからの回答として意図している文の例を幾つか加えることにする。

3.5 スロット情報と問い合わせ文を考慮



したリランキング

まず、最初の検索結果集合を得るために、問い合わせ文を用いたベクトル検索と、問い合わせ文から得られる情報でのスロットフィリングにより埋めた全てのスロット値をキーワードとしたキーワード検索の二つの検索結果に対し、それぞれの検索結果集合での各文書のランクから検索スコアを作成し、各文書に対するスコアを組み合わせて新しいランク付けを作成するハイブリット検索を行う。
その後、ユーザとシステムとの対話の中でのスロットフィリングにより埋めた全てのスロット値をキーワードとしたキーワード検索を行い、その結果を用いてその時点での検索結果集合のリランキングを都度行う。
検索意図を広く捉えたハイブリット検索の結果を、問い合わせ状況における具体的なキーワードであるスロット値でのキーワード検索の結果でリランキングすることで、問い合わせ状況により類似した事例の絞り込みを実現する。


4 システムの構築

まず、システムの検索部分について、ベクトルデータベースである elasticsearch と OpenAI のエンべディングモデルを使用し、コサイン類似度を尺度としたベクトル検索を実装した。
また、スロット情報を用いたキーワード検索については、BM25 アルゴリズムを用いて実装し、検索結果集合と都度行われるキーワード検索の結果の統合によるリランキングには Reciprocal Rank Fusion(RRF)[4]を用いた。
また、問い合わせ意図推定やスロットフィリングを行うシステムは、OpenAI 社が提供する GPT-4o の APIを使用し、それぞれの処理を行わせるために設計したプロンプトを用いて実装した。
プロンプトは、ユーザからの問い合わせ文、システムとユーザの対話文、処理内容、処理に必要な情報の説明、出力形式の指定、処理実行後の想定する出力結果などで構成した。
また、あらかじめ用意した質問文の中か

ら、ユーザからフィードバックをうけるために提示する質問文を選択するため、その時点で埋まっていないスロットのうち一番優先順位の高いスロットに対応する質問文を選択するようなアルゴリズムを組む。
システムが提示した質問に対しユーザが回答するといった対話を行う中で、対応するスロット値を埋めるスロットフィリングを行い、埋めたスロット値を検索結果の絞り込みに活用する。
以上の処理を繰り返し行うようにすることで、提案手法を実装した事故事例文書絞り込み検索システムを構築した。



5 評価実験



5.1 実験設定

構築したシステムを用いて、提案する絞り込み手法の有効性の検証を行う。
検索対象の文書としては畑村らが作成した『失敗知識データベース』[5][6]の事例概要の文を用いることとする。
5 回の評価実験を行うため、評価実験に用いるデータとして、検索対象の文書の中から正解文書として絞り込みたい異なる状況の 5 つの事例を選出し、その状況を想定した際の抽象的な問い合わせ文をそれぞれ作成した。



5.2 評価方法

評価実験においては、上記方法で作成された問い合わせ文をクエリとしてシステムに入力し、システムによって提示される質問に回答していくことで選出した事例である正解文書が元の検索結果集合におけるランクよりも上位にリランキングされるかどうかをみる。
5 つの事例をそれぞれ用いた 5 回の実験において、提案手法の各段階における正解文書のランクの平均をもとめ、それらを比較して評価した。
質問に回答する際には、提示される例を参考にし、質問されている内容に関して選出した事例文から読み取れることを、簡潔に答えるようにした。


5.3 結果

本提案手法により、ユーザとシステムのやり取りを 3 ターン行った際の、各段階においてリランキングされた集合における正解文書のランク平均と、初期検索時の正解文書のランク平均を表 1 に示す。



6 考察

表 1 から、提案手法により、正解文書がより上位に来ていることがわかる。
また、実験に用いた 5 つ表 1 提案手法の各段階における正解文書のランク平均ターン初期検索 1 2 3 29 9 7 6の事例のうち 3 つの事例については、3 ターンのやり取りを終えた時点で１位にランキングされていることを確認しており、提案手法により絞り込みが有効に行われていることがわかる。
一方で、実験に用いた 5 つの事例のうちの１つの事例に関しては絞り込みがうまく行われなかった。
ユーザは、この事例を参考に、「事前の確認」の問い合わせとして「化学工場で起こり得る事故は」と問い合わせたが、「事前の確認」の問い合わせに対して優先的に行われる「作業」に関するスロットを埋めることができなかった。
これは、この問い合わせが、特定の作業をする前に行われる問い合わせではないため、システムから提示される質問に対しユーザが提供できる情報がなく、絞り込みを行うことができなかったためと考えられる。
提案手法においては、問い合わせ意図推定を行った結果によって埋めるべきスロットの優先順位をあらかじめ定めておき、提示する質問の選択に活用しているが、問い合わせ意図推定の結果や初期の検索結果集合の結果によって、埋めるべきスロットの優先順位を動的に決定することができれば、上記のような事例に関しても有効に絞り込みを行うことができるようになるのではと考える。

7 まとめ

本稿では、現場利用者の情報要求に応じた類似事例文書を得るために、事故事例文書の絞り込みを行うシステムを構築することを目的とし、問い合わせ文からの問い合わせ意図推定、システムが能動的に行う質問に対してユーザが回答文を入力するやり取りの中でのスロットフィリング、フィリングした情報をもとにリランキングを行い絞り込みを行う手法を提案した。
また、この手法の有効性を検証するために、提案手法を扱うシステムを作成し評価実験を行った。
抽象的な問い合わせ文を入力とし、ユーザがシステムが提示する質問に回答していくことで、正解文書が初期の検索結果でのランクよりも上位にリランキングされることを確認した。
今後の課題は、問い合わせ意図推定の結果や初期の検索結果集合の結果によって、埋めるべきスロットの優先順位を動的に決定できるようにすることなどがある。



参考文献


[1] 畠中翔太, 島田諭, 三浦孝夫. 適合性フィードバックに基づく検索意図を反映させた文書ランキング. inDEIM Forum 2013 B3-1, 2013.
[2] 尾崎花奈, 十河泰弘. ユーザの検索意図を組み込んだ特許文書絞り込み検索のための質問生成手法. 人工知能学会全国大会論文集 第 37 回, 2023.
[3] Zengfeng Zeng, Dan Ma, Haiqin Yang, and Zhen Gou.Automatic intent-slot induction for dialogue systems. InWWW, pp. 2578–2589, 2021.
[4] Gordon V. Cormack, Charles L A Clarke, and StefanBuettcher. Reciprocal rank fusion outperforms condorcetand individual rank learning methods. SIGIR ’09:Pro-ceedings of the 32nd international ACM SIGIR con-ference on Research and development in informationretrieval, pp. 758–759, 2009.
[5] 畑村洋太郎, 中尾政之, 飯野謙次ほか. 失敗知識データベー ス 構築 の 試み. 情報 処 理, Vol. 44, No. 7, pp.733–739, 2003.
[6] 失 敗 知 識 デ ー タ ベ ー ス, （2022-10 閲 覧）. http://www.shippai.org/fkd/index.php.